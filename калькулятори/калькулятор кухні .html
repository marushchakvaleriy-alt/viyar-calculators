<html lang="uk">
<head>
<meta charset="utf-8"/>
<title>Калькулятор поінтів — Viyar</title>
<style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f3f4f6;
      font-size: 14px;
    }
    .wrapper {
      max-width: 1100px;
      margin: 20px auto;
      background: white;
      padding: 10px 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    header {
      padding: 10px 0;
      position: relative;
      background: white;
    }
    .title-small {
      font-size: 12px;
      color: #4b5563;
      margin-bottom: 4px;
    }
    .header-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    header img { height: 32px; }
    header label { margin-left: 6px; font-size: 13px; }
    input, select {
      font-size: 14px;
      padding: 6px 10px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      background: #fff;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    input:focus, select:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 2px rgba(37,99,235,0.2);
    }
    header input { width: 110px; }
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 6px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
    }
    button:hover { background: #1d4ed8; }
    .settings-btn {
      position: absolute;
      top: 0;
      right: 8px;
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #374151;
    }
    .settings-btn:hover { color: #111827; }
    .section { margin: 20px 0; }
    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      align-items: start;
    }
    .facade-list label {
      display: block;
      margin: 8px 0 4px;
    }
    .hidden { display: none; }
    /* Модальне вікно */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .modal-content h3 {
      margin-top: 0;
      font-size: 18px;
      color: #dc2626;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .modal-content button {
      margin-top: 15px;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .modal-header h3 {
      margin: 0;
      color: #333;
    }
    .close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #666;
      padding: 0;
      margin: 0;
    }
    .close:hover {
      color: #000;
    }
    .modal-actions {
      margin-top: 15px;
      text-align: right;
    }
    .modal-actions button {
      margin-left: 10px;
    }
    
    /* Стилі для кнопки видалення (×) */
    .remove-btn {
      background: none !important;
      border: none !important;
      color: #000 !important;
      font-size: 16px !important;
      cursor: pointer !important;
      padding: 2px 6px !important;
      margin-left: 8px !important;
      border-radius: 0 !important;
      font-weight: bold !important;
    }
    .remove-btn:hover {
      color: #dc2626 !important;
      background: none !important;
    }
  
    .settings-modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.35); z-index: 9999; }
    .settings-content { position: relative; background:#fff; padding:16px 20px; border-radius:12px; max-width:720px; width:95%; max-height:80vh; overflow:auto; box-shadow:0 10px 30px rgba(0,0,0,.2); }
    .settings-close { position:absolute; top:10px; right:12px; border:none; background:transparent; font-size:20px; line-height:1; cursor:pointer; color:#6b7280; }
    .settings-close:hover { color:#111827; }
  
    .header-bar { display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .points-hud { display:inline-block; padding:8px 14px; border-radius:999px; background:#eef2ff; color:#1d4ed8; font-weight:700; border:1px solid #c7d2fe; font-size:16px; }
    @media (max-width:640px){ .points-hud { font-size:12px; padding:4px 8px; } }
    
    /* Кнопка повернення */
    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background: #1976d2;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      color: white;
      text-decoration: none;
      font-size: 24px;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(25, 118, 210, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .back-button:hover {
      background: #1565c0;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(25, 118, 210, 0.4);
      text-decoration: none;
      color: white;
    }

    @media (max-width: 768px) {
      .back-button {
        top: 15px;
        left: 15px;
        width: 45px;
        height: 45px;
        font-size: 20px;
      }
    }
    
    /* Підказки */
    .tooltip-container {
      position: relative;
      display: inline-block;
      margin-left: 5px;
    }
    .tooltip-icon {
      display: inline-block;
      width: 16px;
      height: 16px;
      background: #6b7280;
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 16px;
      font-size: 12px;
      font-weight: bold;
      cursor: help;
      vertical-align: middle;
    }
    .tooltip-icon:hover {
      background: #374151;
    }
    .tooltip-content {
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background: #1f2937;
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 12px;
      line-height: 1.4;
      white-space: nowrap;
      max-width: 300px;
      white-space: normal;
      z-index: 1000;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }
    .tooltip-content::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 5px solid transparent;
      border-top-color: #1f2937;
    }
    .tooltip-container:hover .tooltip-content {
      opacity: 1;
      visibility: visible;
    }
    
    /* Поле пароля */
    .password-field {
      display: none;
      margin: 10px 0;
      padding: 10px;
      background: #f9fafb;
      border: 1px solid #d1d5db;
      border-radius: 8px;
    }
    .password-field input {
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      margin-right: 10px;
      width: 200px;
    }
    .password-field button {
      padding: 8px 16px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .password-field button:hover {
      background: #1d4ed8;
    }
    .password-error {
      color: #dc2626;
      font-size: 12px;
      margin-top: 5px;
    }
    
    /* Стилі для друку - оптимізовано для А4 */
    @media print {
      @page {
        size: A4;
        margin: 0.5cm 0.5cm 0.5cm 0.5cm;
      }
      
      .no-print,
      .header-bar,
      .password-field,
      .calc-actions,
      .modal,
      .password-modal,
      .settings-modal {
        display: none !important;
      }
      
      /* Показуємо поінти при друку */
      .points-hud {
        display: inline-block !important;
        background: #f0f0f0 !important;
        border: 1px solid #ccc !important;
        padding: 3px 6px !important;
        margin: 5px 0 !important;
        font-weight: bold !important;
        font-size: 12px !important;
      }
      
      * {
        box-sizing: border-box;
      }
      
      body {
        font-size: 10px !important;
        line-height: 1.2 !important;
        margin: 0 !important;
        padding: 0 !important;
        color: #000 !important;
        background: white !important;
      }
      
      .wrapper {
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
        max-width: none !important;
      }
      
      header {
        margin: 0 0 5px 0 !important;
        padding: 0 !important;
        page-break-after: avoid;
      }
      
      .container {
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
      }
      
      .section {
        margin: 0 0 5px 0 !important;
        padding: 0 !important;
        page-break-inside: avoid;
        break-inside: avoid;
        orphans: 1;
        widows: 1;
      }
      
      h3 {
        font-size: 11px !important;
        margin: 3px 0 2px 0 !important;
        color: #000 !important;
        page-break-after: avoid;
        font-weight: bold !important;
      }
      
      label {
        font-size: 9px !important;
        margin: 0 0 1px 0 !important;
        display: inline-block !important;
        width: auto !important;
      }
      
      input, select {
        font-size: 9px !important;
        padding: 1px 2px !important;
        margin: 0 0 1px 0 !important;
        border: 1px solid #ccc !important;
        width: 60px !important;
        height: 16px !important;
      }
      
      /* Компактний макет для полів */
      .section > div {
        margin: 0 !important;
        padding: 0 !important;
      }
      
      /* Групування полів в рядки */
      .section label {
        display: inline-block !important;
        width: 120px !important;
        margin-right: 5px !important;
        vertical-align: top !important;
      }
      
      .section input, .section select {
        display: inline-block !important;
        width: 50px !important;
        margin-right: 15px !important;
        margin-bottom: 2px !important;
      }
      
      /* Спеціальні правила для flex-контейнерів */
      .section div[style*="flex"] {
        display: block !important;
      }
      
      .section div[style*="flex"] > div {
        display: inline-block !important;
        margin-right: 20px !important;
        vertical-align: top !important;
      }
      
      /* Приховуємо зайві елементи */
      .tooltip-container {
        display: none !important;
      }
      
      /* Мінімальні відступи */
      br {
        line-height: 0.5 !important;
      }
      
      /* Уникаємо розривів сторінки */
      .section:nth-child(5),
      .section:nth-child(6),
      .section:nth-child(7),
      .section:nth-child(8),
      .section:nth-child(9),
      .section:nth-child(10) {
        page-break-before: avoid !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
      }
    }
  </style>
</head>
<body>
<!-- Кнопка повернення -->
<a href="../../index.html" class="back-button">←</a>

<div class="wrapper">
<header>
<div class="title-small header-bar">Калькулятор поінтів (Кухня) v1.6</div>
<div class="header-line">
<img alt="Viyar" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAEbAnEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9U6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACk3UtNY0AG7HY1Tuta0+xOLm9gtz/01kVf5muI+InjiTTnOnafJtnxmWXrsyOAPf8Axry6SZ5ZC8rs8jdWZsn86/EeJvEuhk2KlgsHT9rOPxNuyv29T6XA5LPFU1VqS5U9u59GWupWt6pNvcRzjrmNg38qsbvY1832d5Pp86zW0zwSr0eM4NeyeAvFx8SWLpcbVvYcCTbwGHZgM16HCfiFhuIqywdeHs6z27PyRlmGUVMHH2kXzROtzRSUor9dPnxaKKKYBRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFRyfyqSmMOfaplqrAfO+uTPca5fyyHLNM55/3jx+HT8Ko9a6Xx9oMmjeIZ5NhFvcsZI26gknJH1zn8xXNZDciv89s9wtfB5niKOJVpqT/ABd7n69hKkKtGEobWQvPeuo+G1y9v4utlXpKrIw9RtJ/mP1rl+PWvQPhPockl9JqcikRRjy4892PUj8P517fBeFxGKz7CrDp3jK7fZLdnLmlSFPCVObqrHqhPBpy96TG4U5a/vA/KxaKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKa3HNAC5oz+FN+9yOadikAZozSbaM4oAWik3D1oWgB1FFFMAooooAKSlprdaAF3UZpPejtSAXNLTdtByKAHU1qBQevSmBR1fR7XXLNra7iEsZ6diD6g9jXnt98H5/MY2d8pTsJgQR+I6/lXqHakX8a+SznhXKc+kp46jeS6rR/ed+Gx1fC/wpWR5zo/whSOYPqN35yj/AJZQjaD9T1r0CzsorC3SGCNYo0GFVRwBU/50jVvk/DmW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L6V4+R8o5/CkzuG4Hce/ft/Kjua/qXA4WOCw8MPTWkUl/wAE/lfG4qWNxE8RN6ydxKM9v8ilz2Fdz8FfhvP8VPiTo/h9IpHtZpRJeugP7u2U5kJPbI+UE/xMvrWuJrwwtGdao9Iq7MsPQnia0aNNaydkfbn7F/wz/wCEH+FMWr3UHlaprzi8cMOVgAIhX6bSX/7aGvoNagsbWGxtIba3jWKCFBGkaDAVQMAD2FWK/lvHYqeOxM8RPeTuf1Nl+EjgcLTw0PsoWiiiuE9AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigArJ8SeFtJ8Xae9hrOnWuqWTjmC7iWRfTIBHB68itaiqjJxalF2aJlGM4uMldM+Svih+wZo2qLLd+C9SfR7n7wsb5mlt/orffT8d30r5l8T/s2/EnwrdvBP4R1G9VTgT6XCbuNx6jywSPxANfqfRX2uB4uzHBx5JtVF/e/zPh8fwfl2MlzwvTfl/kfl94P/AGWfiT4xuo4l8OXGkQMfmudWH2dEBI5Kt85/BTX3V8B/gDo/wS0F4bZxf6zcgfa9SkQBpMdEUfwoM9Px+nq9FcWa8SY3No+znaMOy/U7Mp4ZweUz9rC8p92NCn1paWivlT64KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/Z"/>
<label>Проєкт № <input id="projectNum" placeholder="Номер" type="text"/></label>
<label>Назва виробу <input id="productName" placeholder="Назва" type="text"/></label>
<label>Менеджер <input id="managerName" placeholder="Прізвище" type="text"/></label>
<label>Дата 
<input id="dateField" placeholder="Дата автоматично" type="text" readonly style="background-color: #f5f5f5; cursor: not-allowed;" value=""/>
<script>
(function() {
  const dateField = document.getElementById("dateField");
  if (dateField) {
    const today = new Date();
    const day = String(today.getDate()).padStart(2, '0');
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const year = today.getFullYear();
    dateField.value = `${day}-${month}-${year}`;
  }
})();
</script>
</label>
<button class="no-print" onclick="saveData()">Зберегти</button>
<button class="no-print" onclick="loadData()">Завантажити</button>
<button class="no-print" onclick="window.print()">Друк</button><button id="topClearBtn" class="no-print" style="margin-left:8px;background:#ef4444;color:#fff;border:none;border-radius:6px;padding:6px 12px;cursor:pointer;">Очистити</button><button style="display:none"></button>
<button class="settings-btn no-print" onclick="toggleSettings()">⚙</button>
</div>
</header>
<div class="container">
<!-- Розділ 1 -->
<div class="section">
<h3>1. Основні параметри</h3>
<div style="display: flex; gap: 40px; align-items: flex-start;">
  <div>
    <label for="kitchenForm">Форма кухні:</label><br/>
    <select id="kitchenForm">
      <option value="">-- Виберіть форму --</option>
      <option value="Пряма">Пряма</option>
      <option value="Г-подібна">Г-подібна</option>
      <option value="П-подібна">П-подібна</option>
    </select>
    <br/><br/>
    <label for="measure">Заміри:</label><br/>
    <select id="measure">
      <option value="">-- Виберіть --</option>
      <option value="Без замірів">Без замірів</option>
      <option value="По замірам 3D">По замірам 3D</option>
      <option value="По замірам фото-ескіз">По замірам фото-ескіз</option>
    </select>
    <br/><br/>
    <label for="island">Наявність острова:</label><br/>
    <select id="island">
      <option value="">-- Виберіть --</option>
      <option value="Так">Так</option>
      <option value="Ні">Ні</option>
    </select>
  </div>

  <div style="margin-left: 30px;">
    <label for="geom">Нестандартна геометрія приміщення:<span class="tooltip-container"><span class="tooltip-icon">?</span><div class="tooltip-content">Наявність колон, вент-шахт, виступів, балок тощо</div></span></label><br/>
    <select id="geom">
      <option value="">-- Виберіть --</option>
      <option value="Так">Так</option>
      <option value="Ні">Ні</option>
    </select>
    <br/><br/>
    <label for="vent">Наявність вентмагістралі:</label><br/>
    <select id="vent">
      <option value="">-- Виберіть --</option>
      <option value="Так">Так</option>
      <option value="Ні">Ні</option>
    </select>
  </div>
</div><!-- Розділ 2 -->
<div class="section">
<h3>2. Матеріали</h3>
<label for="corpus">Матеріал корпусу (шт.):</label>
<input id="corpus" min="0" onfocus="this.select()" type="number" value="0"/><br/><br/>
<label for="glassSelect">Скло-дзеркало:</label>
<select id="glassSelect" onchange="toggleGlassCount()">
<option value="">-- Виберіть --</option>
<option value="Так">Так</option>
<option value="Ні">Ні</option>
</select>
<div class="hidden" id="glassCountWrapper">
<br/>
<label for="glassCount">Кількість скло-дзеркал (шт.):</label>
<input id="glassCount" min="0" onfocus="this.select()" type="number" value="0"/>
</div><br/><br/>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <label for="hasFacadeMaterials">Фасадні матеріали:</label>
  <select id="hasFacadeMaterials" onchange="toggleFacadeMaterialsFields()">
    <option value="">-- Виберіть --</option>
    <option value="yes">Так</option>
    <option value="no">Ні</option>
  </select>
  <button type="button" id="addFacadeMaterialBtn" onclick="showAddFacadeMaterialModal()" class="hidden" style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
    + Додати матеріал
  </button>
</div>
<div class="hidden" id="facadeMaterialsFields">
<div id="facadeMaterialsList"></div>
</div>
</div>
<!-- Розділ 3 -->
<div class="section">
<h3>3. Стільниці</h3>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <label for="hasCountertops">Стільниці:</label>
  <select id="hasCountertops" onchange="toggleCountertopsFields()">
    <option value="">-- Виберіть --</option>
    <option value="yes">Так</option>
    <option value="no">Ні</option>
  </select>
  <button type="button" id="addCountertopBtn" onclick="showAddCountertopModal()" class="hidden" style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
    + Додати стільницю
  </button>
</div>
<div class="hidden" id="countertopsFields">
<div id="countertopsList"></div>
</div>
</div>
<!-- Розділ 4 -->
<div class="section">
<h3>4. Фартух (стіна/панелі)</h3>
<label for="hasBacksplash">Є фартух:</label>
<select id="hasBacksplash" onchange="toggleBacksplashFields()">
<option value="">-- Виберіть --</option>
<option value="Так">Так</option>
<option value="Ні">Ні</option>
</select>
<div class="hidden" id="backsplashFields">
<br/>
<label for="backsplashMaterial">Матеріал:</label>
<select id="backsplashMaterial">
<option value="">-- Виберіть --</option>
<option value="ДСП-МДФ">ДСП-МДФ</option>
<option value="Керамограніт-Кварц">Керамограніт-Кварц</option>
<option value="HPL">HPL</option>
<option value="Акрил">Акрил</option>
<option value="Скло">Скло</option>
<option value="R&amp;D (дерево-метал)">R&amp;D (дерево-метал)</option>
</select>
</div>
</div>
<!-- Розділ 5 -->
<div class="section">
<h3>5. Корпуса-модулі</h3>
<div style="display: flex; flex-direction: column; gap: 10px;">
<div style="display: flex; gap: 40px;">
<div>
<label for="lowerModules">Нижні:</label><br/>
<input id="lowerModules" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/>
</div>
<div style="margin-left: 30px;">
<label for="topModules">Антресолі:</label><br/>
<input id="topModules" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/>
</div>
</div>
<div style="display: flex; gap: 40px;">
<div>
<label for="upperModules">Верхні:</label><br/>
<input id="upperModules" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/>
</div>
<div style="margin-left: 30px;">
<label for="tallModules">Пенали:</label><br/>
<input id="tallModules" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/>
</div>
</div>
</div>
<!-- Розділ 5 -->
<div class="section">
<h3>6. Додаткові елементи – конструкції<span class="tooltip-container"><span class="tooltip-icon">?</span><div class="tooltip-content">Фальш панелі горизонтальні<br/>Фальш панелі вертикальні<br/>Фальш панелі R&D<br/>Металеві конструкції<br/>Радіусні елементи</div></span></h3>
<label for="hasAdditionalElements">Додаткові елементи:</label>
<select id="hasAdditionalElements" onchange="toggleAdditionalElementsFields()">
<option value="">-- Виберіть --</option>
<option value="yes">Так</option>
<option value="no">Ні</option>
</select>
<button type="button" id="addAdditionalElementBtn" onclick="showAddAdditionalElementModal()" class="hidden" style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
+ Додати елемент
</button>
<div class="hidden" id="additionalElementsFields">
<div id="additionalElementsList"></div>
</div>
</div>
<!-- Розділ 6 -->
<div class="section">
<h3>7. Функціональна фурнітура</h3>
<label for="furnDrawers">Ящики:</label>
<input id="furnDrawers" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnLifts">Підійомні механізми:</label>
<input id="furnLifts" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnCargo">Карго-колона / сушки / смітники:</label>
<input id="furnCargo" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnMagic">Магічний кут:</label>
<input id="furnMagic" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnServo">Елементи з Servo-Drive:</label>
<input id="furnServo" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnConsole">Консольні полиці (менсолотримач):</label>
<input id="furnConsole" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnTopDrawers">Висувний механізм для верхніх шухляд:</label>
<input id="furnTopDrawers" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnSlidingDoors">Системи розсувних дверей (Revego, Hawa, Salice):</label>
<input id="furnSlidingDoors" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/><br/><br/>
<label for="furnSlideM">Розсувні системи (типу Slide M):</label>
<input id="furnSlideM" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/>
</div>
<!-- Розділ 7 -->
<div class="section">
<h3>8. Ручки</h3>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <label for="hasHandles">Ручки:</label>
  <select id="hasHandles" onchange="toggleHandlesFields()">
    <option value="">-- Виберіть --</option>
    <option value="yes">Так</option>
    <option value="no">Ні</option>
  </select>
  <button type="button" id="addHandleBtn" onclick="showAddHandleModal()" class="hidden" style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
    + Додати ручку
  </button>
</div>
<div class="hidden" id="handlesFields">
<div id="handlesList"></div>
</div>
</div>
<script>
      </script>
<!-- Розділ 8 -->
<div class="section">
<h3>9. Підсвітка</h3>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <label for="hasLighting">Підсвітка:</label>
  <select id="hasLighting" onchange="toggleLightingFields()">
    <option value="">-- Виберіть --</option>
    <option value="yes">Так</option>
    <option value="no">Ні</option>
  </select>
  <button type="button" id="addLightingBtn" onclick="showAddLightingModal()" class="hidden" style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
    + Додати підсвітку
  </button>
</div>
<div class="hidden" id="lightingFields">
<div id="lightingList"></div>
</div>
<h3>10. Вбудована техніка</h3>
<label for="appliancesCount">К-сть одиниць:<span class="tooltip-container"><span class="tooltip-icon">?</span><div class="tooltip-content">Кількість одиниць техніки (мийки, витяжка, духовка, холодильник тощо)</div></span></label>
<input id="appliancesCount" min="0" onfocus="this.select()" placeholder="Вкажіть кількість або 0" type="number"/>
</div>
<button class="no-print" onclick="calculate()">Розрахувати</button>
</div>
</div>

<!-- Модальне вікно -->
<div class="points-hud" id="pointsHUD" style="display: none;">Поінти: 0</div>
<div class="modal" id="warningModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
  <div class="modal-content">
    <h3>⚠️ Помилка</h3>
    <p id="warningText"></p>
    <button onclick="closeModal()">OK</button>
  </div>
</div>
<script>
    const facadeOptions = [
      "ДСП мат. корпусу","ДСП","МДФ плити","Фарба/плівка 'прямі'","Фарба/плівка 'фрезеровані'",
      "Шпоновані 'прямі'","Шпоновані 'фрезеровані'","Алюм. рамкові","ARPA/Fenix",
      "Fiushin","HPL","R&D фасади індивід.","МДФ фасади з індивідуальним фрезеруванням"
    ];

    function generateFacades() {
      const count = parseInt(document.getElementById("facadeCount").value) || 0;
      const container = document.getElementById("facadeContainer");
      container.innerHTML = "";
      if (count > 13) return;
      for (let i = 1; i <= count; i++) {
        const label = document.createElement("label");
        label.innerText = "Матеріал фасадів №" + i + ":";
        const select = document.createElement("select");
        select.id = "facade_" + i;
        const defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.textContent = "-- Виберіть --";
        select.appendChild(defaultOption);
        facadeOptions.forEach(opt => {
          const option = document.createElement("option");
          option.value = opt;
          option.textContent = opt;
          select.appendChild(option);
        });
        container.appendChild(label);
        container.appendChild(select);
        container.appendChild(document.createElement("br"));
      }
    }

    function toggleFacadeMaterialsFields() {
      const hasFacadeMaterials = document.getElementById("hasFacadeMaterials").value;
      const fields = document.getElementById("facadeMaterialsFields");
      const addButton = document.getElementById("addFacadeMaterialBtn");
      
      if (hasFacadeMaterials === "yes") {
        fields.classList.remove("hidden");
        addButton.classList.remove("hidden");
      } else {
        fields.classList.add("hidden");
        addButton.classList.add("hidden");
        // Очищаємо список матеріалів
        document.getElementById("facadeMaterialsList").innerHTML = "";
      }
    }

    function showAddFacadeMaterialModal() {
      document.getElementById('addFacadeMaterialModal').style.display = 'flex';
    }

    function closeAddFacadeMaterialModal() {
      document.getElementById('addFacadeMaterialModal').style.display = 'none';
      // Скидаємо поля
      document.getElementById('newFacadeMaterialType').value = '';
    }

    function addFacadeMaterialOnSelect() {
      const materialType = document.getElementById("newFacadeMaterialType").value;
      
      if (!materialType) return;

      const materialNames = {
        "dsp_mat": "ДСП мат.корпусу",
        "dsp": "ДСП", 
        "mdf": "МДФ плити",
        "paint_straight": "Фарба/плівка 'прямі'",
        "paint_milled": "Фарба/плівка 'фрезеровані'",
        "veneer_straight": "Шпоновані 'прямі'",
        "veneer_milled": "Шпоновані 'фрезеровані'",
        "alum_frame": "Алюм. рамкові",
        "arpa": "ARPA/Fenix",
        "fiushin": "Fiushin",
        "hpl": "HPL",
        "rd_individual": "R&D фасади індивід.",
        "mdf_individual": "МДФ фасади з індивідуальним фрезеруванням"
      };

      const displayName = materialNames[materialType] || materialType;
      const materialsList = document.getElementById("facadeMaterialsList");
      
      // Створюємо новий елемент
      const materialDiv = document.createElement("div");
      materialDiv.className = "element-item";
      materialDiv.id = `facadeMaterial_${materialType}_${Date.now()}`;
      materialDiv.setAttribute('data-material-type', materialType);
      
      materialDiv.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px; font-size: 14px;">
          <span class="material-number"></span>. ${displayName}
          <button type="button" class="remove-btn" onclick="removeFacadeMaterial('${materialDiv.id}')" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">×</button>
        </div>
      `;
      
      materialsList.appendChild(materialDiv);
      
      // Перенумеровуємо всі матеріали
      updateFacadeMaterialNumbers();
      
      // Закриваємо модальне вікно
      closeAddFacadeMaterialModal();
    }

    function updateFacadeMaterialNumbers() {
      const materialsList = document.getElementById("facadeMaterialsList");
      const materials = materialsList.querySelectorAll('[id^="facadeMaterial_"]');
      
      const materialNames = {
        "dsp_mat": "ДСП мат.корпусу",
        "dsp": "ДСП", 
        "mdf": "МДФ плити",
        "paint_straight": "Фарба/плівка 'прямі'",
        "paint_milled": "Фарба/плівка 'фрезеровані'",
        "veneer_straight": "Шпоновані 'прямі'",
        "veneer_milled": "Шпоновані 'фрезеровані'",
        "alum_frame": "Алюм. рамкові",
        "arpa": "ARPA/Fenix",
        "fiushin": "Fiushin",
        "hpl": "HPL",
        "rd_individual": "R&D фасади індивід.",
        "mdf_individual": "МДФ фасади з індивідуальним фрезеруванням"
      };
      
      materials.forEach((material, index) => {
        const materialType = material.getAttribute('data-material-type');
        const displayName = materialNames[materialType] || materialType;
        const numberSpan = material.querySelector('.material-number');
        if (numberSpan) {
          numberSpan.textContent = `${index + 1}`;
        }
      });
    }

    function removeFacadeMaterial(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        element.remove();
        // Перенумеровуємо матеріали після видалення
        updateFacadeMaterialNumbers();
      }
    }


    // Функції для додаткових елементів
    function showAddAdditionalElementModal() {
      document.getElementById('addAdditionalElementModal').style.display = 'flex';
    }

    function closeAddAdditionalElementModal() {
      document.getElementById('addAdditionalElementModal').style.display = 'none';
      document.getElementById('newAdditionalElementType').value = '';
      document.getElementById('newAdditionalElementQuantity').value = '1';
    }

    function addAdditionalElement() {
      const elementType = document.getElementById("newAdditionalElementType").value;
      const quantity = parseInt(document.getElementById("newAdditionalElementQuantity").value) || 1;
      
      if (!elementType) {
        alert('Будь ласка, виберіть тип елементу');
        return;
      }

      const elementNames = {
        "false_hor": "Фальш горизонтальні",
        "false_ver": "Фальш вертикальні", 
        "detail_rd": "Деталь R&D, гнутий елемент тощо",
        "metal_frame": "Металоконструкція рамкова",
        "metal_volume": "Металоконструкція об'ємна"
      };

      const displayName = elementNames[elementType] || elementType;
      const elementsList = document.getElementById("additionalElementsList");
      
      // Створюємо новий елемент
      const elementDiv = document.createElement("div");
      elementDiv.className = "element-item";
      elementDiv.id = `additionalElement_${elementType}_${Date.now()}`;
      elementDiv.setAttribute('data-element-type', elementType);
      elementDiv.setAttribute('data-quantity', quantity);
      
      elementDiv.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px; font-size: 14px;">
          <span class="element-number"></span>. ${displayName}
          <input type="number" id="quantity_${elementDiv.id}" value="${quantity}" min="1" onchange="updateAdditionalElementQuantity('${elementDiv.id}')" style="width: 100px; padding: 5px; border: 1px solid #ccc; border-radius: 4px;">
          <button type="button" class="remove-btn" onclick="removeAdditionalElement('${elementDiv.id}')" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">×</button>
        </div>
      `;
      
      elementsList.appendChild(elementDiv);
      
      // Перенумеровуємо всі елементи
      updateAdditionalElementNumbers();
      
      // Закриваємо модальне вікно
      closeAddAdditionalElementModal();
    }

    function updateAdditionalElementNumbers() {
      const elementsList = document.getElementById("additionalElementsList");
      const elements = elementsList.querySelectorAll('[id^="additionalElement_"]');
      
      const elementNames = {
        "false_hor": "Фальш горизонтальні",
        "false_ver": "Фальш вертикальні", 
        "detail_rd": "Деталь R&D, гнутий елемент тощо",
        "metal_frame": "Металоконструкція рамкова",
        "metal_volume": "Металоконструкція об'ємна"
      };
      
      elements.forEach((element, index) => {
        const elementType = element.getAttribute('data-element-type');
        const displayName = elementNames[elementType] || elementType;
        const label = element.querySelector('label');
        if (label) {
          label.textContent = `${index + 1}. ${displayName}`;
        }
      });
    }

    function removeAdditionalElement(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        element.remove();
        // Перенумеровуємо елементи після видалення
        updateAdditionalElementNumbers();
      }
    }

    function updateAdditionalElementQuantity(elementId) {
      const element = document.getElementById(elementId);
      if (!element) return;
      
      const input = element.querySelector('input[type="number"]');
      const newQuantity = parseInt(input.value) || 1;
      
      if (newQuantity < 1) {
        input.value = 1;
        element.setAttribute('data-quantity', 1);
      } else {
        element.setAttribute('data-quantity', newQuantity);
      }
    }

    // Функції для ручок
    function showAddHandleModal() {
      document.getElementById('addHandleModal').style.display = 'flex';
    }

    function closeAddHandleModal() {
      document.getElementById('addHandleModal').style.display = 'none';
      document.getElementById('newHandleType').value = '';
    }

    function addHandle() {
      const handleType = document.getElementById("newHandleType").value;
      if (!handleType) {
        alert('Будь ласка, виберіть тип ручки');
        return;
      }

      const handleNames = {
        "handles_gola_low": "GOLA низ",
        "handles_gola_up": "GOLA верх",
        "handles_gola_vert": "GOLA вертикал.",
        "handles_end": "Торцеві",
        "handles_milled": "Фрезеровані",
        "handles_other": "Інші"
      };

      const displayName = handleNames[handleType] || handleType;
      const handlesList = document.getElementById("handlesList");
      
      const handleDiv = document.createElement("div");
      handleDiv.className = "element-item";
      handleDiv.id = `handle_${handleType}_${Date.now()}`;
      handleDiv.setAttribute('data-handle-type', handleType);
      
      handleDiv.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px; font-size: 14px;">
          <span class="handle-number"></span>. ${displayName}
          <button type="button" class="remove-btn" onclick="removeHandle('${handleDiv.id}')" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">×</button>
        </div>
      `;
      
      handlesList.appendChild(handleDiv);
      updateHandleNumbers();
      closeAddHandleModal();
    }

    function updateHandleNumbers() {
      const handlesList = document.getElementById("handlesList");
      const handles = handlesList.querySelectorAll('[id^="handle_"]');
      const handleNames = {
        "handles_gola_low": "GOLA низ",
        "handles_gola_up": "GOLA верх",
        "handles_gola_vert": "GOLA вертикал.",
        "handles_end": "Торцеві",
        "handles_milled": "Фрезеровані",
        "handles_other": "Інші"
      };
      
      handles.forEach((handle, index) => {
        const handleType = handle.getAttribute('data-handle-type');
        const displayName = handleNames[handleType] || handleType;
        const numberSpan = handle.querySelector('.handle-number');
        if (numberSpan) {
          numberSpan.textContent = `${index + 1}`;
        }
      });
    }

    function removeHandle(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        element.remove();
        updateHandleNumbers();
      }
    }


    // Функції для підсвітки
    function showAddLightingModal() {
      document.getElementById('addLightingModal').style.display = 'flex';
    }

    function closeAddLightingModal() {
      document.getElementById('addLightingModal').style.display = 'none';
      document.getElementById('newLightingType').value = '';
      document.getElementById('newLightingQuantity').value = '1';
      document.getElementById('lightingQuantityField').style.display = 'none';
    }

    function showLightingQuantityField() {
      const lightingType = document.getElementById("newLightingType").value;
      const quantityField = document.getElementById('lightingQuantityField');
      
      if (lightingType === 'light_modules' || lightingType === 'light_other') {
        quantityField.style.display = 'block';
      } else {
        quantityField.style.display = 'none';
      }
    }


    function addLightingFromModal() {
      const lightingType = document.getElementById("newLightingType").value;
      
      if (!lightingType) {
        alert('Будь ласка, виберіть тип підсвітки');
        return;
      }

      let quantity = 1;
      if (lightingType === 'light_modules' || lightingType === 'light_other') {
        quantity = parseInt(document.getElementById("newLightingQuantity").value) || 1;
      }

      const lightingNames = {
        "light_modules": "К-сть модулів (корпусів) з підсвіткою (в боковинах, полицях, ящиках)",
        "light_work": "Підсвітка робочої зони",
        "light_base": "Підсвітка цоколя",
        "light_other": "Інше (окремий модуль підсвітки, один відрізок)"
      };

      const lightingTooltips = {
        "light_modules": "Підсвітка в середині модулів-пеналів (в боковинах, полицях, підсвітка ящиків тощо)",
        "light_work": "Підсвітка робочої поверхні",
        "light_base": "Підсвітка цоколя шафи",
        "light_other": "Окремий модуль підсвітки"
      };

      const displayName = lightingNames[lightingType] || lightingType;
      const tooltip = lightingTooltips[lightingType] || "";
      const lightingList = document.getElementById("lightingList");
      
      const lightingDiv = document.createElement("div");
      lightingDiv.className = "element-item";
      lightingDiv.id = `lighting_${lightingType}_${Date.now()}`;
      lightingDiv.setAttribute('data-lighting-type', lightingType);
      lightingDiv.setAttribute('data-quantity', quantity);
      
      const quantityInput = (lightingType === 'light_modules' || lightingType === 'light_other') 
        ? `<input type="number" id="quantity_${lightingDiv.id}" value="${quantity}" min="1" onchange="updateLightingQuantity('${lightingDiv.id}')" style="width: 100px; padding: 5px; border: 1px solid #ccc; border-radius: 4px;">`
        : '';
      
      const tooltipHtml = tooltip ? `<span class="tooltip-container"><span class="tooltip-icon">?</span><div class="tooltip-content">${tooltip}</div></span>` : '';
      
      lightingDiv.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px; font-size: 14px;">
          <span class="lighting-number"></span>. ${displayName}${tooltipHtml}
          ${quantityInput}
          <button type="button" class="remove-btn" onclick="removeLighting('${lightingDiv.id}')" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">×</button>
        </div>
      `;
      
      lightingList.appendChild(lightingDiv);
      updateLightingNumbers();
      closeAddLightingModal();
    }

    function updateLightingNumbers() {
      const lightingList = document.getElementById("lightingList");
      const lights = lightingList.querySelectorAll('[id^="lighting_"]');
      const lightingNames = {
        "light_modules": "К-сть модулів (корпусів) з підсвіткою (в боковинах, полицях, ящиках)",
        "light_work": "Підсвітка робочої зони",
        "light_base": "Підсвітка цоколя",
        "light_other": "Інше (окремий модуль підсвітки, один відрізок)"
      };
      
      lights.forEach((light, index) => {
        const lightingType = light.getAttribute('data-lighting-type');
        const quantity = parseInt(light.getAttribute('data-quantity')) || 1;
        const displayName = lightingNames[lightingType] || lightingType;
        const numberSpan = light.querySelector('.lighting-number');
        if (numberSpan) {
          numberSpan.textContent = `${index + 1}`;
        }
      });
    }

    function removeLighting(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        element.remove();
        updateLightingNumbers();
      }
    }

    function updateLightingQuantity(elementId) {
      const element = document.getElementById(elementId);
      if (!element) return;
      
      const input = element.querySelector('input[type="number"]');
      const newQuantity = parseInt(input.value) || 1;
      
      if (newQuantity < 1) {
        input.value = 1;
        element.setAttribute('data-quantity', 1);
      } else {
        element.setAttribute('data-quantity', newQuantity);
      }
    }
    
    function toggleGlassCount() {
      const glass = document.getElementById("glassSelect").value;
      const wrapper = document.getElementById("glassCountWrapper");
      wrapper.classList.toggle("hidden", glass !== "Так");
    }

    // ===== ФУНКЦІЇ ДЛЯ СТІЛЬНИЦЬ =====
    
    // Функція для переключення полів стільниць
    function toggleCountertopsFields() {
      const hasCountertops = document.getElementById("hasCountertops").value;
      const fields = document.getElementById("countertopsFields");
      const addButton = document.getElementById("addCountertopBtn");
      
      if (hasCountertops === "yes") {
        fields.classList.remove("hidden");
        addButton.classList.remove("hidden");
      } else {
        fields.classList.add("hidden");
        addButton.classList.add("hidden");
        // Очищаємо список стільниць
        document.getElementById("countertopsList").innerHTML = "";
      }
    }

    // Функція для відкриття модального вікна додавання стільниці
    function showAddCountertopModal() {
      document.getElementById('addCountertopModal').style.display = 'flex';
      // Скидаємо поля
      document.getElementById('newCountertopMaterial').value = '';
      document.getElementById('newCountertopShape').value = '';
      document.getElementById('newCountertopDrops').value = '';
    }

    // Функція для закриття модального вікна стільниць
    function closeAddCountertopModal() {
      document.getElementById('addCountertopModal').style.display = 'none';
    }

    // Функція для додавання стільниці
    function addCountertop() {
      const material = document.getElementById("newCountertopMaterial").value;
      const shape = document.getElementById("newCountertopShape").value;
      const drops = document.getElementById("newCountertopDrops").value;
      const quantity = 1; // За замовчуванням 1
      
      if (!material || !shape || !drops) {
        alert('Будь ласка, заповніть всі поля');
        return;
      }

      const materialNames = {
        "dsp_mdf": "ДСП-МДФ",
        "ceramic": "Керамограніт-Кварц", 
        "hpl": "HPL",
        "acryl": "Акрил",
        "rd": "R&D (дерево-метал)"
      };
      
      const shapeNames = {
        "straight": "Прямий",
        "g_shape": "Г-подібний",
        "p_shape": "П-подібний"
      };
      
      const dropsNames = {
        "yes": "з опусками",
        "no": "без опусків"
      };

      const materialName = materialNames[material] || material;
      const shapeName = shapeNames[shape] || shape;
      const dropsName = dropsNames[drops] || drops;
      
      const countertopsList = document.getElementById("countertopsList");
      const countertopId = `countertop_${Date.now()}`;
      
      // Створюємо новий елемент
      const countertopDiv = document.createElement("div");
      countertopDiv.id = countertopId;
      countertopDiv.style.cssText = "padding: 4px 0; margin-bottom: 3px;";
      countertopDiv.setAttribute('data-material', material);
      countertopDiv.setAttribute('data-shape', shape);
      countertopDiv.setAttribute('data-drops', drops);
      countertopDiv.setAttribute('data-quantity', quantity);
      
      countertopDiv.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px; font-size: 14px;">
          <span class="countertop-number"></span>. ${materialName}, ${shapeName}, ${dropsName}
          <input type="number" id="quantity_${countertopId}" value="${quantity}" min="1" onchange="updateCountertopQuantity('${countertopId}')" style="width: 100px; padding: 5px; border: 1px solid #ccc; border-radius: 4px;">
          <button onclick="removeCountertop('${countertopId}')" class="remove-btn" title="Видалити" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">×</button>
        </div>
      `;
      
      countertopsList.appendChild(countertopDiv);
      
      // Оновлюємо нумерацію
      updateCountertopNumbers();
      
      // Закриваємо модальне вікно
      closeAddCountertopModal();
    }

    // Функція для оновлення нумерації стільниць
    function updateCountertopNumbers() {
      const countertopsList = document.getElementById("countertopsList");
      const countertops = countertopsList.querySelectorAll('[id^="countertop_"]');
      
      countertops.forEach((countertop, index) => {
        const numberSpan = countertop.querySelector('.countertop-number');
        if (numberSpan) {
          numberSpan.textContent = index + 1;
        }
      });
    }

    // Функція для видалення стільниці
    function removeCountertop(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        element.remove();
        // Перенумеровуємо стільниці після видалення
        updateCountertopNumbers();
      }
    }

    function updateCountertopQuantity(elementId) {
      const element = document.getElementById(elementId);
      if (!element) return;
      
      const input = element.querySelector('input[type="number"]');
      const newQuantity = parseInt(input.value) || 1;
      
      if (newQuantity < 1) {
        input.value = 1;
        element.setAttribute('data-quantity', 1);
      } else {
        element.setAttribute('data-quantity', newQuantity);
      }
    }

    
    function toggleBacksplashFields() {
      const hasBack = document.getElementById("hasBacksplash").value;
      const fields = document.getElementById("backsplashFields");
      fields.classList.toggle("hidden", hasBack !== "Так");
    }

    function toggleLightingFields() {
      const hasLighting = document.getElementById("hasLighting").value;
      const fields = document.getElementById("lightingFields");
      const addButton = document.getElementById("addLightingBtn");
      
      if (hasLighting === "yes") {
        fields.classList.remove("hidden");
        addButton.classList.remove("hidden");
      } else {
        fields.classList.add("hidden");
        addButton.classList.add("hidden");
        // Очищаємо список підсвітки
        document.getElementById("lightingList").innerHTML = "";
      }
    }
    
    function toggleHandlesFields() {
      const hasHandles = document.getElementById("hasHandles").value;
      const fields = document.getElementById("handlesFields");
      const addButton = document.getElementById("addHandleBtn");
      
      if (hasHandles === "yes") {
        fields.classList.remove("hidden");
        addButton.classList.remove("hidden");
      } else {
        fields.classList.add("hidden");
        addButton.classList.add("hidden");
        // Очищаємо список ручок
        document.getElementById("handlesList").innerHTML = "";
      }
    }
    
    function toggleAdditionalElementsFields() {
      const hasAdditionalElements = document.getElementById("hasAdditionalElements").value;
      const fields = document.getElementById("additionalElementsFields");
      const addButton = document.getElementById("addAdditionalElementBtn");
      
      if (hasAdditionalElements === "yes") {
        fields.classList.remove("hidden");
        addButton.classList.remove("hidden");
      } else {
        fields.classList.add("hidden");
        addButton.classList.add("hidden");
        // Очищаємо список елементів
        document.getElementById("additionalElementsList").innerHTML = "";
      }
    }


    function calculate() {
      // Перевіряємо всі обов'язкові поля
      const missingFields = checkRequiredFields();
      
      if (missingFields.length > 0) {
        showMissingFieldsWarning(missingFields);
        return;
      }
      
      calculateTotal();
    }
    
    function checkRequiredFields() {
      const missing = [];
      
      // 1. Основні параметри
      if (!document.getElementById("kitchenForm")?.value) {
        missing.push("1. Форма кухні");
      }
      if (!document.getElementById("measure")?.value) {
        missing.push("1. Тип замірів");
      }
      if (!document.getElementById("island")?.value) {
        missing.push("1. Острів");
      }
      if (!document.getElementById("geom")?.value) {
        missing.push("1. Нестандартна геометрія");
      }
      if (!document.getElementById("vent")?.value) {
        missing.push("1. Вентиляційна шахта");
      }
      
      // 2. Матеріали
      const corpus = document.getElementById("corpus")?.value;
      if (!corpus || parseInt(corpus) <= 0) {
        missing.push("2. Матеріал корпуса (кількість)");
      }
      
      const hasFacadeMaterials = document.getElementById("hasFacadeMaterials")?.value;
      if (!hasFacadeMaterials) {
        missing.push("2. Фасадні матеріали (вибір)");
      }
      if (hasFacadeMaterials === "yes") {
        const facadeMaterials = document.querySelectorAll('[id^="facadeMaterial_"]');
        if (facadeMaterials.length === 0) {
          missing.push("2. Фасадні матеріали (не додано жодного)");
        }
      }
      
      // 3. Скло-дзеркало
      const glassSelect = document.getElementById("glassSelect")?.value;
      if (!glassSelect) {
        missing.push("3. Скло-дзеркало (вибір)");
      }
      if (glassSelect === "Так") {
        const glassCount = document.getElementById("glassCount")?.value;
        if (!glassCount || parseInt(glassCount) <= 0) {
          missing.push("3. Скло-дзеркало (кількість)");
        }
      }
      
      // 4. Стільниці - перевіряємо динамічні стільниці
      const hasCountertops = document.getElementById("hasCountertops");
      if (!hasCountertops || !hasCountertops.value) {
        missing.push("4. Стільниці (вибір)");
      } else if (hasCountertops.value === "yes") {
        const countertops = document.querySelectorAll('[id^="countertop_"]');
        if (countertops.length === 0) {
          missing.push("4. Стільниці (не додано жодної)");
        }
      }
      
      // 5. Корпуса-модулі
      const moduleFields = ["lowerModules", "upperModules", "topModules", "tallModules"];
      for (let fieldId of moduleFields) {
        const field = document.getElementById(fieldId);
        if (!field || field.value === "") {
          const labels = {
            "lowerModules": "5. Нижні модулі",
            "upperModules": "5. Верхні модулі",
            "topModules": "5. Антресолі",
            "tallModules": "5. Пенали"
          };
          missing.push(labels[fieldId]);
        }
      }
      
      // 6. Додаткові елементи - перевіряємо динамічні елементи
      const hasAdditionalElements = document.getElementById("hasAdditionalElements");
      if (!hasAdditionalElements || !hasAdditionalElements.value) {
        missing.push("6. Додаткові елементи (вибір)");
      } else if (hasAdditionalElements.value === "yes") {
        const additionalElements = document.querySelectorAll('[id^="additionalElement_"]');
        if (additionalElements.length === 0) {
          missing.push("6. Додаткові елементи (не додано жодного)");
        }
      }
      
      // 7. Функціональна фурнітура
      const furnFields = ["furnDrawers", "furnLifts", "furnCargo", "furnMagic", "furnServo", "furnConsole", "furnTopDrawers", "furnSlidingDoors", "furnSlideM"];
      for (let fieldId of furnFields) {
        const field = document.getElementById(fieldId);
        if (!field || field.value === "") {
          const labels = {
            "furnDrawers": "7. Ящики",
            "furnLifts": "7. Підійомні механізми",
            "furnCargo": "7. Карго-колона / сушки / смітники",
            "furnMagic": "7. Магічний кут",
            "furnServo": "7. Елементи з Servo-Drive",
            "furnConsole": "7. Консольні полиці",
            "furnTopDrawers": "7. Висувний механізм для верхніх шухляд",
            "furnSlidingDoors": "7. Системи розсувних дверей",
            "furnSlideM": "7. Розсувні системи (типу Slide M)"
          };
          missing.push(labels[fieldId]);
        }
      }
      
      // 8. Ручки - перевіряємо динамічні ручки
      const hasHandles = document.getElementById("hasHandles");
      if (!hasHandles || !hasHandles.value) {
        missing.push("8. Ручки (вибір)");
      } else if (hasHandles.value === "yes") {
        const handles = document.querySelectorAll('[id^="handle_"]');
        if (handles.length === 0) {
          missing.push("8. Ручки (не додано жодної)");
        }
      }
      
      // 9. Підсвітка - перевіряємо динамічну підсвітку
      const hasLighting = document.getElementById("hasLighting");
      if (!hasLighting || !hasLighting.value) {
        missing.push("9. Підсвітка (вибір)");
      } else if (hasLighting.value === "yes") {
        const lights = document.querySelectorAll('[id^="lighting_"]');
        if (lights.length === 0) {
          missing.push("9. Підсвітка (не додано жодного типу)");
        }
      }
      
      // 10. Вбудована техніка
      const appliancesCount = document.getElementById("appliancesCount")?.value;
      if (!appliancesCount || appliancesCount === "") {
        missing.push("10. Вбудована техніка (кількість)");
      }
      
      return missing;
    }
    
    function showMissingFieldsWarning(missingFields) {
      let warningText = "Не заповнені наступні поля:\n\n";
      missingFields.forEach((field) => {
        warningText += `${field}\n`;
      });
      
      document.getElementById("warningText").innerText = warningText;
      document.getElementById("warningModal").style.display = "flex";
    }

    function showWarning(text) {
      document.getElementById("warningText").innerText = text;
      document.getElementById("warningModal").style.display = "flex";
    }

    /*
    // TEMP: старий код валідації - видалити
    function oldCode() {
      // Перевірка скла-дзеркала
      const glassSelect = document.getElementById("glassSelect").value;
      if (!glassSelect) {
        showWarning("Виберіть, чи є скло-дзеркало.");
        return;
      }
      if (glassSelect === "Так") {
        const glassCount = parseInt(document.getElementById("glassCount").value) || 0;
        if (glassCount === 0) {
          showWarning("Вкажіть кількість скло-дзеркал.");
          return;
        }
      }
      for (let i = 1; i <= facadeCount; i++) {
        const val = document.getElementById("facade_" + i).value;
        if (!val) {
          showWarning("Виберіть усі матеріали фасадів.");
          return;
        }
      }

      // Розділ 3
      const hasCountertop = document.getElementById("hasCountertop").value;
      if (!hasCountertop) {
        showWarning("Вкажіть, чи є стільниця.");
        return;
      }
      if (hasCountertop === "Так") {
        const mat = document.getElementById("counterMaterial").value;
        const shape = document.getElementById("counterShape").value;
        const drops = document.getElementById("counterDrops").value;
        if (!mat || !shape || !drops) {
          showWarning("Заповніть усі поля для стільниці.");
          return;
        }
      }


      // Розділ 5
      const lower = document.getElementById("lowerModules").value;
      const upper = document.getElementById("upperModules").value;
      const top = document.getElementById("topModules").value;
      const tall = document.getElementById("tallModules").value;
      if (lower === "" || upper === "" || top === "" || tall === "") {
        showWarning("Заповніть усі поля в розділі 5 (корпуса-модулі).");
        return;
      }


      // Розділ 6 - Додаткові елементи
      const hasAdditionalElements = document.getElementById("hasAdditionalElements").value;
      if (!hasAdditionalElements) {
        showWarning("Вкажіть, чи є додаткові елементи.");
        return;
      }
      if (hasAdditionalElements === "yes") {
        const additionalElements = document.querySelectorAll('[id^="additionalElement_"]');
        if (additionalElements.length === 0) {
          showWarning("Додайте хоча б один додатковий елемент.");
          return;
        }
      }

      
      
      // Розділ 6
      const furnIds = [
        "furnDrawers","furnLifts","furnCargo","furnMagic",
        "furnServo","furnConsole","furnTopDrawers",
        "furnSlidingDoors","furnSlideM"
      ];
      for (let id of furnIds) {
        const val = document.getElementById(id).value;
        if (val === "") {
          showWarning("Заповніть усі поля в розділі 6 (Функціональна фурнітура).");
          return;
        }
        if (parseInt(val) < 0) {
          showWarning("Значення не може бути від’ємним у розділі 6.");
          return;
        }
      }

      
      // Розділ 7

      // Розділ 8 - Підсвітка
      const hasLighting = document.getElementById("hasLighting").value;
      if (!hasLighting) {
        showWarning("Вкажіть, чи є підсвітка.");
        return;
      }
      if (hasLighting === "yes") {
        const lights = document.querySelectorAll('[id^="lighting_"]');
        if (lights.length === 0) {
          showWarning("Додайте хоча б один тип підсвітки.");
          return;
        }
      }

      // Розділ 9 - Вбудована техніка
      const appliancesCount = document.getElementById("appliancesCount").value;
      if (appliancesCount === "") {
        showWarning("Оберіть кількість вбудованої техніки.");
        return;
      }
      if (parseInt(appliancesCount) < 0) {
        showWarning("Кількість вбудованої техніки не може бути від’ємною.");
        return;
      }

      // Розділ 7 - Ручки
      const hasHandles = document.getElementById("hasHandles").value;
      if (!hasHandles) {
        showWarning("Вкажіть, чи є ручки.");
        return;
      }
      if (hasHandles === "yes") {
        const handles = document.querySelectorAll('[id^="handle_"]');
        if (handles.length === 0) {
          showWarning("Додайте хоча б одну ручку.");
          return;
        }
      }

      calculateTotal();
    }
    */

    function toggleFacadeMaterialsFields() {
      const hasFacadeMaterials = document.getElementById("hasFacadeMaterials").value;
      const fields = document.getElementById("facadeMaterialsFields");
      const btn = document.getElementById("addFacadeMaterialBtn");
      
      if (hasFacadeMaterials === "yes") {
        fields.classList.remove("hidden");
        btn.classList.remove("hidden");
      } else {
        fields.classList.add("hidden");
        btn.classList.add("hidden");
        // Очистити список матеріалів
        document.getElementById("facadeMaterialsList").innerHTML = "";
      }
    }

    function closeModal() {
      document.getElementById("warningModal").style.display = "none";
    }

    function saveData() {
      try {
        // Збираємо всі дані форми
        const formData = {};
        document.querySelectorAll('input, select, textarea').forEach(el => {
          if (el.id && !el.closest('#inlineSaveControls')) {
            const value = el.type === 'checkbox' || el.type === 'radio' ? el.checked : el.value;
            formData[el.id] = value;
          }
        });
        
        // Додаємо метадані
        const data = {
          meta: {
            kind: 'viyar-kitchen-calc',
            version: '1.6',
            timestamp: new Date().toISOString()
          },
          values: formData
        };
        
        // Зберігаємо в localStorage
        localStorage.setItem('kitchen_calc_data', JSON.stringify(data));
        
        // Створюємо файл для завантаження
        const filename = buildFilename();
        const text = JSON.stringify(data, null, 2);
        const blob = new Blob([text], {type: 'application/json;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        
        // Створюємо посилання для завантаження
        const downloadLink = document.createElement('a');
        downloadLink.href = url;
        downloadLink.download = filename;
        downloadLink.style.display = 'none';
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        
        // Очищуємо URL через 30 секунд
        setTimeout(() => {
          try { URL.revokeObjectURL(url); } catch(e) {}
        }, 30000);
        
        alert('Дані збережено успішно!');
        // Поінти не показуються автоматично - натисніть "Розрахувати"
      } catch (error) {
        console.error('Помилка збереження:', error);
        alert('Помилка збереження: ' + error.message);
      }
    }

    function loadData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json,.vcalc.json';
      
      input.onchange = function(e) {
        const file = e.target.files && e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(ev) {
          try {
            const data = JSON.parse(ev.target.result);
            if (data && data.values) {
              // Застосовуємо збережені дані
              Object.keys(data.values).forEach(key => {
                const el = document.getElementById(key);
                if (el) {
                  if (el.type === 'checkbox' || el.type === 'radio') {
                    el.checked = data.values[key] === true || data.values[key] === '1';
                  } else {
                    el.value = data.values[key];
                  }
                  // Тригеримо події для перерахунку
                  el.dispatchEvent(new Event('input', {bubbles: true}));
                  el.dispatchEvent(new Event('change', {bubbles: true}));
                }
              });
              alert('Дані завантажено успішно!');
              // Поінти не показуються автоматично - натисніть "Розрахувати"
            } else {
              alert('Невірний формат файлу');
            }
          } catch (error) {
            console.error('Помилка завантаження:', error);
            alert('Помилка завантаження: ' + error.message);
          }
        };
        reader.readAsText(file, 'utf-8');
      };
      input.click();
    }
    
    function buildFilename() {
      const project = document.getElementById('projectNum')?.value?.trim() || '';
      const manager = document.getElementById('managerName')?.value?.trim() || '';
      const date = document.getElementById('dateField')?.value?.trim() || new Date().toISOString().split('T')[0];
      
      const parts = [];
      if (project) parts.push(project.replace(/\s+/g, '_'));
      if (manager) parts.push(manager.replace(/\s+/g, '_'));
      parts.push(date);
      
      const base = parts.join('__') || 'kitchen_calc_' + new Date().toISOString().split('T')[0];
      return base + '.vcalc.json';
    }
    
    // Безпечна версія розрахунку без валідації
    function calculateTotalSafe() {
      function getSettingValue(id) {
        const el = document.getElementById(id);
        const v = el ? parseFloat(el.value) : 0;
        return isNaN(v) ? 0 : v;
      }
      
      function valInt(id) {
        const el = document.getElementById(id);
        if (!el) return 0;
        const v = parseInt(el.value);
        return isNaN(v) ? 0 : v;
      }
      
      function valYes(id) {
        const el = document.getElementById(id);
        return el && (el.value === "Так" || el.value === "так" || el.value === "yes" || el.value === "1");
      }
      
      function addDetail(label, count, tariffId) {
        const t = getSettingValue(tariffId);
        if (!count || !t) return;
        points += count * t;
      }

      let points = 0;

      // ===== 1. Основні параметри =====
      (function(){
        const form = (document.getElementById("kitchenForm")?.value || "").trim();
        if (form === "Пряма") addDetail("Форма кухні: Пряма", 1, "p_forma_pryama");
        else if (form === "Г-подібна") addDetail("Форма кухні: Г-подібна", 1, "p_forma_g");
        else if (form === "П-подібна") addDetail("Форма кухні: П-подібна", 1, "p_forma_p");

        const measure = (document.getElementById("measure")?.value || "").trim();
        if (measure === "Без замірів") addDetail("Без замірів", 1, "p_bez_zamiriv");
        else if (measure === "По замірам 3D") addDetail("По замірам 3D", 1, "p_zamir_3d");
        else if (measure === "По замірам фото-ескіз") addDetail("По замірам фото-ескіз", 1, "p_zamir_foto");

        const geomYes = (document.getElementById("geom")?.value || "").trim().toLowerCase() === "так";
        if (geomYes) addDetail("Нестандартна геометрія", 1, "p_geo");

        const ventYes = (document.getElementById("vent")?.value || "").trim().toLowerCase() === "так";
        if (ventYes) addDetail("Вентмагістраль", 1, "p_vent");

        const islandYes = (document.getElementById("island")?.value || "").trim().toLowerCase() == "так";
        if (islandYes) addDetail("Острів", 1, "p_island");
      })();

      // ===== 2. Матеріали =====
      (function(){
        const corpusCount = parseInt(document.getElementById("corpus")?.value) || 0;
        if (corpusCount > 0) addDetail("Матеріал корпусу", corpusCount, "p_mat_corpus");

        const glassSel = (document.getElementById("glassSelect")?.value || "").trim().toLowerCase();
        const glassCount = parseInt(document.getElementById("glassCount")?.value) || 0;
        if (glassSel === "так" && glassCount > 0) addDetail("Скло-дзеркало", glassCount, "p_mat_glass");
      })();

      // 2. Матеріали - Фасадні матеріали (нова система)
      const hasFacadeMaterials = document.getElementById("hasFacadeMaterials")?.value;
      if (hasFacadeMaterials === "yes") {
        const facadeMaterials = document.querySelectorAll('[id^="facadeMaterial_"]');
        const materialMapping = {
          "dsp_mat": "p_facade_dsp_mat",
          "dsp": "p_facade_dsp", 
          "mdf": "p_facade_mdf",
          "paint_straight": "p_facade_paint_straight",
          "paint_milled": "p_facade_paint_milled",
          "veneer_straight": "p_facade_veneer_straight",
          "veneer_milled": "p_facade_veneer_milled",
          "alum_frame": "p_facade_alum_frame",
          "arpa": "p_facade_arpa",
          "fiushin": "p_facade_fiushin",
          "hpl": "p_facade_hpl",
          "rd_individual": "p_facade_rd_individual",
          "mdf_individual": "p_facade_mdf_individual"
        };

        facadeMaterials.forEach(material => {
          const materialType = material.getAttribute('data-material-type');
          const materialNames = {
            "veneer_straight": "Шпон прямий",
            "veneer_curved": "Шпон криволінійний", 
            "painted_straight": "Фарбований прямий",
            "painted_curved": "Фарбований криволінійний",
            "laminate_straight": "Ламінований прямий",
            "laminate_curved": "Ламінований криволінійний",
            "acrylic_straight": "Акрил прямий",
            "acrylic_curved": "Акрил криволінійний",
            "mdf_straight": "МДФ прямий",
            "mdf_curved": "МДФ криволінійний",
            "glass_straight": "Скло прямий",
            "glass_curved": "Скло криволінійний"
          };
          
          const materialName = materialNames[materialType] || materialType;
          
          if (materialType && materialMapping[materialType]) {
            addDetail("Фасадний матеріал: " + materialName, 1, materialMapping[materialType]);
          }
        });
      }

      // 3. Стільниці (нова динамічна система)
      const hasCountertops = document.getElementById("hasCountertops")?.value;
      if (hasCountertops === "yes") {
        const countertops = document.querySelectorAll('[id^="countertop_"]');
        
        const materialMapping = {
          "dsp_mdf": "p_tabletop_dsp_mdf",
          "ceramic": "p_tabletop_ceramic", 
          "hpl": "p_tabletop_hpl",
          "acryl": "p_tabletop_acryl",
          "rd": "p_tabletop_rd"
        };
        
        const formMapping = {
          "straight": "p_tabletop_form_straight",
          "g_shape": "p_tabletop_form_g",
          "p_shape": "p_tabletop_form_p"
        };

        countertops.forEach((countertop, index) => {
          const material = countertop.getAttribute('data-material');
          const shape = countertop.getAttribute('data-shape');
          const drops = countertop.getAttribute('data-drops');
          
          // Додаємо поінти за матеріал
          if (material) {
            const materialTariffId = materialMapping[material];
            if (materialTariffId) {
              addDetail(`Стільниця ${index + 1}: ${material}`, 1, materialTariffId);
            }
          }
          
          // Додаємо поінти за форму
          if (shape) {
            const formTariffId = formMapping[shape];
            if (formTariffId) {
              addDetail(`Форма стільниці ${index + 1}: ${shape}`, 1, formTariffId);
            }
          }
          
          // Додаємо поінти за опуски
          if (drops === "yes") {
            addDetail(`Опуски стільниці ${index + 1}`, 1, "p_tabletop_drop");
          }
        });
      }

      // 4. Фартух - поінти тільки за матеріал
      if (valYes("hasBacksplash")) {
        const backsplashMaterial = document.getElementById("backsplashMaterial")?.value;
        if (backsplashMaterial) {
          const materialMapping = {
            "ДСП-МДФ": "p_fartukh_dsp_mdf",
            "Керамограніт-Кварц": "p_fartukh_ceramic",
            "HPL": "p_fartukh_hpl",
            "Акрил": "p_fartukh_acryl",
            "Скло": "p_fartukh_glass",
            "R&D (дерево-метал)": "p_fartukh_rd"
          };
          const tariffId = materialMapping[backsplashMaterial] || "p_fartukh";
          addDetail("Фартух: " + backsplashMaterial, 1, tariffId);
        }
      }

      // 5. Корпуса-модулі
      addDetail("Нижні модулі", valInt("lowerModules"), "p_mod_low");
      addDetail("Верхні модулі", valInt("upperModules"), "p_mod_up");
      addDetail("Антресолі",     valInt("topModules"),   "p_mod_ant");
      addDetail("Пенали",        valInt("tallModules"),  "p_mod_penal");

      // 6. Додаткові елементи (нова система)
      const hasAdditionalElements = document.getElementById("hasAdditionalElements")?.value;
      if (hasAdditionalElements === "yes") {
        const additionalElements = document.querySelectorAll('[id^="additionalElement_"]');
        const elementMapping = {
          "false_hor": "p_false_hor",
          "false_ver": "p_false_ver",
          "detail_rd": "p_detail_rd",
          "metal_frame": "p_metal_frame",
          "metal_volume": "p_metal_volume"
        };

        additionalElements.forEach(element => {
          const elementType = element.getAttribute('data-element-type');
          const elementNames = {
            "false_hor": "Фальш горизонтальні",
            "false_ver": "Фальш вертикальні",
            "detail_rd": "Деталь R&D, гнутий елемент тощо",
            "metal_frame": "Металоконструкція рамкова",
            "metal_volume": "Металоконструкція об'ємна"
          };
          
          const elementName = elementNames[elementType] || elementType;
          
          if (elementType && elementMapping[elementType]) {
            addDetail("Додатковий елемент: " + elementName, 1, elementMapping[elementType]);
          }
        });
      }

      // 7. Функціональна фурнітура
      addDetail("Ящики",                    valInt("furnDrawers"),      "p_furn_drawers");
      addDetail("Підійомні механізми",      valInt("furnLifts"),        "p_furn_lifts");
      addDetail("Карго/сушка/смітник",      valInt("furnCargo"),        "p_furn_cargo");
      addDetail("Магічний кут",             valInt("furnMagic"),        "p_furn_magic");
      addDetail("Servo-Drive",              valInt("furnServo"),        "p_furn_servo");
      addDetail("Консольні полиці",         valInt("furnConsole"),      "p_furn_console");
      addDetail("Верхні шухляди",           valInt("furnTopDrawers"),   "p_furn_top");
      addDetail("Системи розсувних дверей", valInt("furnSlidingDoors"), "p_furn_doors");
      addDetail("Slide M",                  valInt("furnSlideM"),       "p_furn_slide");

      // 7. Ручки - поінти тільки за конкретні типи
      const hasHandles = document.getElementById("hasHandles")?.value;
      if (hasHandles === "yes") {
        const handles = document.querySelectorAll('[id^="handle_"]');
        const handleMapping = {
          "handles_gola_low": "p_handle_gola_low",
          "handles_gola_up": "p_handle_gola_up",
          "handles_gola_vert": "p_handle_gola_vert",
          "handles_end": "p_handle_end",
          "handles_milled": "p_handle_milled",
          "handles_other": "p_handle_other"
        };
        
        handles.forEach(handle => {
          const handleType = handle.getAttribute('data-handle-type');
          const handleNames = {
            "handle_1": "Ручка 1",
            "handle_2": "Ручка 2",
            "handle_3": "Ручка 3",
            "handle_4": "Ручка 4",
            "handle_5": "Ручка 5"
          };
          
          const handleName = handleNames[handleType] || handleType;
          if (handleType && handleMapping[handleType]) {
            addDetail("Ручки: " + handleName, 1, handleMapping[handleType]);
          }
        });
      }

      // 8. Підсвітка
      const hasLighting = document.getElementById("hasLighting")?.value;
      if (hasLighting === "yes") {
        const lights = document.querySelectorAll('[id^="lighting_"]');
        const lightingMapping = {
          "light_modules": "p_light_mod",
          "light_work": "p_light_work",
          "light_base": "p_light_base",
          "light_other": "p_light_other"
        };
        
        lights.forEach(light => {
          const lightingType = light.getAttribute('data-lighting-type');
          const quantity = parseInt(light.getAttribute('data-quantity')) || 1;
          const lightingNames = {
            "light_modules": "К-сть модулів (корпусів) з підсвіткою",
            "light_work": "Підсвітка робочої зони",
            "light_base": "Підсвітка цоколя",
            "light_other": "Інше (окремий модуль підсвітки, один відрізок)"
          };
          
          const lightingName = lightingNames[lightingType] || lightingType;
          if (lightingType && lightingMapping[lightingType]) {
            addDetail("Підсвітка: " + lightingName, quantity, lightingMapping[lightingType]);
          }
        });
      }

      // 9. Вбудована техніка
      addDetail("Вбудована техніка", valInt("appliancesCount"), "p_appliance");

      // Вивід - показуємо поінти тільки після успішного розрахунку
      const out = document.getElementById("pointsResult");
      if (out) {
        out.textContent = "Поінти: " + points;
        out.style.display = "block";
      }
      const hud = document.getElementById("pointsHUD");
      if (hud) {
        hud.textContent = "Поінти: " + points;
        hud.style.display = "inline-block";
      }
    }

    function clearForm() {
      document.querySelectorAll("input, select").forEach(el => {
        if (el.id !== "dateField") {  // Не очищуємо дату
          if (el.id !== "dateField") el.value = "";
        }
      });
      document.getElementById("facadeContainer").innerHTML = "";
      document.getElementById("countertopFields").classList.add("hidden");
      document.getElementById("backsplashFields").classList.add("hidden");
      document.getElementById("lightingFields").classList.add("hidden");
      
      // Приховуємо поінти при очищенні
      const out = document.getElementById("pointsResult");
      if (out) out.style.display = "none";
      const hud = document.getElementById("pointsHUD");
      if (hud) hud.style.display = "none";
    }

    // Пароль для налаштувань
    const correctPassword = '1111'; // Можете змінити пароль
    
    function toggleSettings() {
      document.getElementById('passwordModal').style.display = 'flex';
      document.getElementById('passwordInput').focus();
    }

    function closePasswordModal() {
      document.getElementById('passwordModal').style.display = 'none';
      document.getElementById('passwordInput').value = '';
    }

    function checkPassword() {
      const password = document.getElementById('passwordInput').value;
      
      if (password === correctPassword) {
        closePasswordModal();
        document.getElementById('settingsModal').style.display = 'flex';
      } else {
        alert('Невірний пароль!');
        document.getElementById('passwordInput').value = '';
        document.getElementById('passwordInput').focus();
      }
    }

    function handlePasswordKeypress(event) {
      if (event.key === 'Enter') {
        checkPassword();
      }
    }
    
    function changePassword() {
      const newPassword = document.getElementById('newPassword').value;
      const statusElement = document.getElementById('passwordChangeStatus');
      
      if (newPassword.length < 3) {
        statusElement.textContent = 'Пароль повинен містити мінімум 3 символи';
        statusElement.style.color = '#dc2626';
        return;
      }
      
      // Зберігаємо новий пароль в localStorage
      localStorage.setItem('settings_password', newPassword);
      
      // Оновлюємо поточний пароль
      SETTINGS_PASSWORD = newPassword;
      
      statusElement.textContent = 'Пароль успішно змінено!';
      statusElement.style.color = '#059669';
      document.getElementById('newPassword').value = '';
      
      // Приховуємо повідомлення через 3 секунди
      setTimeout(() => {
        statusElement.textContent = '';
      }, 3000);
    }

    window.onload = function() {
      // Приховуємо поінти при завантаженні
      const out = document.getElementById("pointsResult");
      if (out) out.style.display = "none";
      const hud = document.getElementById("pointsHUD");
      if (hud) hud.style.display = "none";
      
      const dateField = document.getElementById("dateField");
      if (dateField) {
        // Встановлюємо поточну дату
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const year = today.getFullYear();
        const formatted = `${day}-${month}-${year}`;
        dateField.value = formatted;
        
        // Заборона редагування дати користувачем
        dateField.addEventListener('input', function(e) {
          // Відновлюємо правильну дату, якщо користувач спробував змінити
          const today = new Date();
          const day = String(today.getDate()).padStart(2, '0');
          const month = String(today.getMonth() + 1).padStart(2, '0');
          const year = today.getFullYear();
          const formatted = `${day}-${month}-${year}`;
          setTimeout(() => {
            dateField.value = formatted;
          }, 0);
        });
        dateField.addEventListener('keydown', function(e) {
          e.preventDefault();
          return false;
        });
        dateField.addEventListener('paste', function(e) {
          e.preventDefault();
          return false;
        });
      }
      
      // Спробуємо завантажити збережені дані з localStorage
      try {
        const savedData = localStorage.getItem('kitchen_calc_data');
        if (savedData) {
          const data = JSON.parse(savedData);
          if (data && data.values) {
            // Застосовуємо збережені дані
            Object.keys(data.values).forEach(key => {
              const el = document.getElementById(key);
              if (el) {
                if (el.type === 'checkbox' || el.type === 'radio') {
                  el.checked = data.values[key] === true || data.values[key] === '1';
                } else {
                  el.value = data.values[key];
                }
                // Тригеримо події для перерахунку
                el.dispatchEvent(new Event('input', {bubbles: true}));
                el.dispatchEvent(new Event('change', {bubbles: true}));
              }
            });
            console.log('Збережені дані завантажено з localStorage');
            // Поінти не показуються автоматично - натисніть "Розрахувати"
          }
        }
      } catch (error) {
        console.error('Помилка завантаження з localStorage:', error);
      }
      
    }
  </script>

<!-- Модальне вікно для введення пароля -->
<div id="passwordModal" class="modal" style="display: none;">
  <div class="modal-content" style="max-width: 400px;">
    <div class="modal-header">
      <h3>Введіть пароль</h3>
      <button class="close" onclick="closePasswordModal()">&times;</button>
    </div>
    <div>
      <label for="passwordInput">Пароль:</label><br/>
      <input type="password" id="passwordInput" onkeypress="handlePasswordKeypress(event)" style="width: 100%; margin-bottom: 15px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" placeholder="Введіть пароль для доступу до налаштувань">
    </div>
    <div class="modal-actions">
      <button onclick="closePasswordModal()" style="background: #6b7280;">Скасувати</button>
      <button onclick="checkPassword()" style="background: #2563eb;">Відкрити налаштування</button>
    </div>
  </div>
</div>

<div class="modal" id="settingsModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);"><div class="settings-content">
<button aria-label="Закрити" class="settings-close" onclick="closeSettings()">✕</button>
<div style="background:#fff; margin:50px auto; padding:20px; width:80%; height:80%; overflow:auto; border-radius:8px;">
<h2>⚙️ Налаштування поінтів</h2>
<form id="pointsForm">
<h3>🔒 Зміна пароля</h3>
<label for="newPassword">Новий пароль:</label>
<input id="newPassword" type="password" placeholder="Введіть новий пароль" style="width: 200px; margin-right: 10px;"/>
<button type="button" onclick="changePassword()">Змінити пароль</button>
<p id="passwordChangeStatus" style="margin-top: 10px; font-size: 12px;"></p>
<hr style="margin: 20px 0;"/>
<h3>1. Основні параметри</h3>
      Форма кухні - Пряма: <input id="p_forma_pryama" type="number" value="19"/><br/>
      Форма кухні - Г-подібна: <input id="p_forma_g" type="number" value="23"/><br/>
      Форма кухні - П-подібна: <input id="p_forma_p" type="number" value="27"/><br/>
      Нестандартна геометрія: <input id="p_geo" type="number" value="8"/><br/>
      Вентмагістраль: <input id="p_vent" type="number" value="8"/><br/>
      Без замірів: <input id="p_bez_zamiriv" type="number" value="3"/><br/>
      По замірам 3D: <input id="p_zamir_3d" type="number" value="8"/><br/>
      По замірам фото-ескіз: <input id="p_zamir_foto" type="number" value="21"/><br/>
      Острів: <input id="p_island" type="number" value="6"/><br/>
<h3>2. Матеріали</h3>
      Матеріал корпуса: <input id="p_mat_corpus" type="number" value="3"/><br/>
      Скло-дзеркало: <input id="p_mat_glass" type="number" value="2"/><br/>
<h4>Фасадні матеріали:</h4>
      ДСП мат. корпусу: <input id="p_facade_dsp_mat" type="number" value="2"/><br/>
      ДСП: <input id="p_facade_dsp" type="number" value="3"/><br/>
      МДФ плити: <input id="p_facade_mdf" type="number" value="6"/><br/>
      Фарба/плівка 'прямі': <input id="p_facade_paint_straight" type="number" value="10"/><br/>
      Фарба/плівка 'фрезеровані': <input id="p_facade_paint_milled" type="number" value="14"/><br/>
      Шпоновані 'прямі': <input id="p_facade_veneer_straight" type="number" value="12"/><br/>
      Шпоновані 'фрезеровані': <input id="p_facade_veneer_milled" type="number" value="16"/><br/>
      Алюм. рамкові: <input id="p_facade_alum_frame" type="number" value="8"/><br/>
      ARPA/Fenix: <input id="p_facade_arpa" type="number" value="8"/><br/>
      Fiushin: <input id="p_facade_fiushin" type="number" value="10"/><br/>
      HPL: <input id="p_facade_hpl" type="number" value="14"/><br/>
      R&D фасади індивід.: <input id="p_facade_rd_individual" type="number" value="30"/><br/>
      МДФ фасади з індивідуальним фрезеруванням: <input id="p_facade_mdf_individual" type="number" value="17"/><br/>
<h3>3. Стільниці</h3>
      ДСП-МДФ: <input id="p_tabletop_dsp_mdf" type="number" value="6"/><br/>
      Керамограніт-Кварц: <input id="p_tabletop_ceramic" type="number" value="18"/><br/>
      HPL: <input id="p_tabletop_hpl" type="number" value="10"/><br/>
      Акрил: <input id="p_tabletop_acryl" type="number" value="18"/><br/>
      R&D (дерево-метал): <input id="p_tabletop_rd" type="number" value="23"/><br/>
      <h4>Форма стільниці:</h4>
      Прямий: <input id="p_tabletop_form_straight" type="number" value="1"/><br/>
      Г-подібний: <input id="p_tabletop_form_g" type="number" value="3"/><br/>
      П-подібний: <input id="p_tabletop_form_p" type="number" value="5"/><br/>
      <h4>Опуски:</h4>
      Опуски: <input id="p_tabletop_drop" type="number" value="2"/><br/>
<h3>4. Фартух</h3>
      ДСП-МДФ: <input id="p_fartukh_dsp_mdf" type="number" value="3"/><br/>
      Керамограніт-Кварц: <input id="p_fartukh_ceramic" type="number" value="6"/><br/>
      HPL: <input id="p_fartukh_hpl" type="number" value="6"/><br/>
      Акрил: <input id="p_fartukh_acryl" type="number" value="6"/><br/>
      Скло: <input id="p_fartukh_glass" type="number" value="6"/><br/>
      R&D (дерево-метал): <input id="p_fartukh_rd" type="number" value="6"/><br/>
<h3>5. Корпус-модулі</h3>
      Нижні модулі: <input id="p_mod_low" type="number" value="1"/><br/>
      Верхні модулі: <input id="p_mod_up" type="number" value="1"/><br/>
      Антресолі: <input id="p_mod_ant" type="number" value="1"/><br/>
      Пенали: <input id="p_mod_penal" type="number" value="1"/><br/>
<h3>6. Додаткові елементи</h3>
      Фальш горизонтальні: <input id="p_false_hor" type="number" value="1"/><br/>
      Фальш вертикальні: <input id="p_false_ver" type="number" value="1"/><br/>
      Деталь R&D, гнутий елемент тощо: <input id="p_detail_rd" type="number" value="1"/><br/>
      Металоконструкція рамкова: <input id="p_metal_frame" type="number" value="1"/><br/>
      Металоконструкція об'ємна: <input id="p_metal_volume" type="number" value="1"/><br/>
<h3>7. Функціональна фурнітура</h3>
      Ящики: <input id="p_furn_drawers" type="number" value="1"/><br/>
      Підійомні механізми: <input id="p_furn_lifts" type="number" value="1"/><br/>
      Карго/сушки: <input id="p_furn_cargo" type="number" value="1"/><br/>
      Магічний кут: <input id="p_furn_magic" type="number" value="1"/><br/>
      Servo-Drive: <input id="p_furn_servo" type="number" value="1"/><br/>
      Консольні полиці: <input id="p_furn_console" type="number" value="1"/><br/>
      Верхні шухляди: <input id="p_furn_top" type="number" value="1"/><br/>
      Розсувні двері: <input id="p_furn_doors" type="number" value="1"/><br/>
      Slide M: <input id="p_furn_slide" type="number" value="1"/><br/>
<h3>8. Ручки</h3>
      GOLA низ: <input id="p_handle_gola_low" type="number" value="1"/><br/>
      GOLA верх: <input id="p_handle_gola_up" type="number" value="1"/><br/>
      GOLA вертикал.: <input id="p_handle_gola_vert" type="number" value="1"/><br/>
      Торцеві: <input id="p_handle_end" type="number" value="1"/><br/>
      Фрезеровані: <input id="p_handle_milled" type="number" value="1"/><br/>
      Інші: <input id="p_handle_other" type="number" value="1"/><br/>
<h3>9. Вбудована техніка</h3>
      Техніка (одиниця): <input id="p_appliance" type="number" value="1"/><br/>
<h3>10. Підсвітка</h3>
      Модулі з підсвіткою: <input id="p_light_mod" type="number" value="1"/><br/>
      Робоча зона: <input id="p_light_work" type="number" value="1"/><br/>
      Цоколь: <input id="p_light_base" type="number" value="1"/><br/>
      Інше (окремий модуль): <input id="p_light_other" type="number" value="1"/><br/>
<br/><button onclick="savePoints()" type="button">Зберегти</button>
<button onclick="closeSettings()" type="button">Закрити</button>
</form>
</div>
<div class="calc-actions"><button onclick="calculateTotal()" type="button">Розрахувати</button> <span class="points-hud" id="pointsHUD" style="display: none;">Поінти: 0</span></div>
</div>
<script>
function closeSettings() {
  document.getElementById('settingsModal').style.display = 'none';
}
function savePoints() {
  const inputs = document.querySelectorAll('#pointsForm input');
  inputs.forEach(input => {
    localStorage.setItem(input.id, input.value);
  });
  alert('Поінти збережено!');
}
window.onload = () => {
  const inputs = document.querySelectorAll('#pointsForm input');
  inputs.forEach(input => {
    const saved = localStorage.getItem(input.id);
    if (saved !== null) input.value = saved;
  });
};
</script>
<script>
function getSettingValue(id) {
  return parseFloat(document.getElementById(id)?.value) || 0;
}


function calculateTotal() {

function getSettingValue(id) {
  const el = document.getElementById(id);
  const v = el ? parseFloat(el.value) : 0;
  return (Number.isFinite(v) && v > 0) ? v : 0;
}
function valInt(id) {
  const el = document.getElementById(id);
  if (!el) return 0;
  const v = parseInt(el.value);
  return (Number.isFinite(v) && v > 0) ? v : 0; // only positive
}
function valYes(id){
  const el=document.getElementById(id);
  if(!el) return false;
  if(el.type==="checkbox") return !!el.checked;
  const v=(el.value||"").toString().trim().toLowerCase();
  return v==="так"||v==="yes"||v==="1"||v==="true";
}
function addDetail(label, count, tariffId) {
  if (!count || count <= 0) return;
  const t = getSettingValue(tariffId);
  if (!t || t <= 0) return;
  points += count * t;
}


  let points = 0;

  
  // ===== 1. Основні параметри =====
  (function(){
    const form = (document.getElementById("kitchenForm")?.value || "").trim();
    if (form === "Пряма") addDetail("Форма кухні: Пряма", 1, "p_forma_pryama");
    else if (form === "Г-подібна") addDetail("Форма кухні: Г-подібна", 1, "p_forma_g");
    else if (form === "П-подібна") addDetail("Форма кухні: П-подібна", 1, "p_forma_p");

    const measure = (document.getElementById("measure")?.value || "").trim();
    if (measure === "Без замірів") addDetail("Без замірів", 1, "p_bez_zamiriv");
    else if (measure === "По замірам 3D") addDetail("По замірам 3D", 1, "p_zamir_3d");
    else if (measure === "По замірам фото-ескіз") addDetail("По замірам фото-ескіз", 1, "p_zamir_foto");

    const geomYes = (document.getElementById("geom")?.value || "").trim().toLowerCase() === "так";
    if (geomYes) addDetail("Нестандартна геометрія", 1, "p_geo");

    const ventYes = (document.getElementById("vent")?.value || "").trim().toLowerCase() === "так";
    if (ventYes) addDetail("Вентмагістраль", 1, "p_vent");

    const islandYes = (document.getElementById("island")?.value || "").trim().toLowerCase() == "так";
    if (islandYes) addDetail("Острів", 1, "p_island");
  })();

  // ===== 2. Матеріали =====
  (function(){
    const corpusCount = parseInt(document.getElementById("corpus")?.value) || 0;
    if (corpusCount > 0) addDetail("Матеріал корпусу", corpusCount, "p_mat_corpus");

    const glassSel = (document.getElementById("glassSelect")?.value || "").trim().toLowerCase();
    const glassCount = parseInt(document.getElementById("glassCount")?.value) || 0;
    if (glassSel === "так" && glassCount > 0) addDetail("Скло-дзеркало", glassCount, "p_mat_glass");

    // Фасадні матеріали вже додаються нижче як 'facadeCount' * p_mat_facade.
  })();

function getSettingValue(id) {
    const el = document.getElementById(id);
    const v = el ? parseFloat(el.value) : 0;
    return isNaN(v) ? 0 : v;
  }
  function valInt(id) {
    const el = document.getElementById(id);
    if (!el) return 0;
    const v = parseInt(el.value);
    return isNaN(v) ? 0 : v;
  }
  function valYes(id) {
    const el = document.getElementById(id);
    return el && (el.value === "Так" || el.value === "так" || el.value === "yes" || el.value === "1");
  }
  function addDetail(label, count, tariffId) {
    const t = getSettingValue(tariffId);
    if (!count || !t) return;
    points += count * t;
  }

  // 2. Матеріали - Фасадні матеріали (нова система)
  const hasFacadeMaterials = document.getElementById("hasFacadeMaterials")?.value;
  if (hasFacadeMaterials === "yes") {
    const facadeMaterials = document.querySelectorAll('[id^="facadeMaterial_"]');
    const materialMapping = {
      "dsp_mat": "p_facade_dsp_mat",
      "dsp": "p_facade_dsp", 
      "mdf": "p_facade_mdf",
      "paint_straight": "p_facade_paint_straight",
      "paint_milled": "p_facade_paint_milled",
      "veneer_straight": "p_facade_veneer_straight",
      "veneer_milled": "p_facade_veneer_milled",
      "alum_frame": "p_facade_alum_frame",
      "arpa": "p_facade_arpa",
      "fiushin": "p_facade_fiushin",
      "hpl": "p_facade_hpl",
      "rd_individual": "p_facade_rd_individual",
      "mdf_individual": "p_facade_mdf_individual"
    };

    facadeMaterials.forEach(material => {
      const materialType = material.getAttribute('data-material-type');
      const materialNames = {
        "veneer_straight": "Шпон прямий",
        "veneer_curved": "Шпон криволінійний", 
        "painted_straight": "Фарбований прямий",
        "painted_curved": "Фарбований криволінійний",
        "laminate_straight": "Ламінований прямий",
        "laminate_curved": "Ламінований криволінійний",
        "acrylic_straight": "Акрил прямий",
        "acrylic_curved": "Акрил криволінійний",
        "mdf_straight": "МДФ прямий",
        "mdf_curved": "МДФ криволінійний",
        "glass_straight": "Скло прямий",
        "glass_curved": "Скло криволінійний"
      };
      
      const materialName = materialNames[materialType] || materialType;
      
      if (materialType && materialMapping[materialType]) {
        addDetail("Фасадний матеріал: " + materialName, 1, materialMapping[materialType]);
      }
    });
  }

  // 3. Стільниці (нова динамічна система)
  const hasCountertops = document.getElementById("hasCountertops")?.value;
  if (hasCountertops === "yes") {
    const countertops = document.querySelectorAll('[id^="countertop_"]');
    
    const materialMapping = {
      "dsp_mdf": "p_tabletop_dsp_mdf",
      "ceramic": "p_tabletop_ceramic", 
      "hpl": "p_tabletop_hpl",
      "acryl": "p_tabletop_acryl",
      "rd": "p_tabletop_rd"
    };
    
    const formMapping = {
      "straight": "p_tabletop_form_straight",
      "g_shape": "p_tabletop_form_g",
      "p_shape": "p_tabletop_form_p"
    };

    countertops.forEach((countertop, index) => {
      const material = countertop.getAttribute('data-material');
      const shape = countertop.getAttribute('data-shape');
      const drops = countertop.getAttribute('data-drops');
      
      // Додаємо поінти за матеріал
      if (material) {
        const materialTariffId = materialMapping[material];
        if (materialTariffId) {
          addDetail(`Стільниця ${index + 1}: ${material}`, 1, materialTariffId);
        }
      }
      
      // Додаємо поінти за форму
      if (shape) {
        const formTariffId = formMapping[shape];
        if (formTariffId) {
          addDetail(`Форма стільниці ${index + 1}: ${shape}`, 1, formTariffId);
        }
      }
      
      // Додаємо поінти за опуски
      if (drops === "yes") {
        addDetail(`Опуски стільниці ${index + 1}`, 1, "p_tabletop_drop");
      }
    });
  }

  // 4. Фартух - поінти тільки за матеріал
  if (valYes("hasBacksplash")) {
    const backsplashMaterial = document.getElementById("backsplashMaterial")?.value;
    if (backsplashMaterial) {
      const materialMapping = {
        "ДСП-МДФ": "p_fartukh_dsp_mdf",
        "Керамограніт-Кварц": "p_fartukh_ceramic",
        "HPL": "p_fartukh_hpl",
        "Акрил": "p_fartukh_acryl",
        "Скло": "p_fartukh_glass",
        "R&D (дерево-метал)": "p_fartukh_rd"
      };
      const tariffId = materialMapping[backsplashMaterial] || "p_fartukh";
      addDetail("Фартух: " + backsplashMaterial, 1, tariffId);
    }
  }

  // 5. Корпуса-модулі
  addDetail("Нижні модулі", valInt("lowerModules"), "p_mod_low");
  addDetail("Верхні модулі", valInt("upperModules"), "p_mod_up");
  addDetail("Антресолі",     valInt("topModules"),   "p_mod_ant");
  addDetail("Пенали",        valInt("tallModules"),  "p_mod_penal");

  // 6. Додаткові елементи (нова система)
  const hasAdditionalElements = document.getElementById("hasAdditionalElements")?.value;
  if (hasAdditionalElements === "yes") {
    const additionalElements = document.querySelectorAll('[id^="additionalElement_"]');
    const elementMapping = {
      "false_hor": "p_false_hor",
      "false_ver": "p_false_ver",
      "detail_rd": "p_detail_rd",
      "metal_frame": "p_metal_frame",
      "metal_volume": "p_metal_volume"
    };

    additionalElements.forEach(element => {
      const elementType = element.getAttribute('data-element-type');
      const elementNames = {
        "false_hor": "Фальш горизонтальні",
        "false_ver": "Фальш вертикальні",
        "detail_rd": "Деталь R&D, гнутий елемент тощо",
        "metal_frame": "Металоконструкція рамкова",
        "metal_volume": "Металоконструкція об'ємна"
      };
      
      const elementName = elementNames[elementType] || elementType;
      
      if (elementType && elementMapping[elementType]) {
        addDetail("Додатковий елемент: " + elementName, 1, elementMapping[elementType]);
      }
    });
  }

  // 7. Функціональна фурнітура
  addDetail("Ящики",                    valInt("furnDrawers"),      "p_furn_drawers");
  addDetail("Підійомні механізми",      valInt("furnLifts"),        "p_furn_lifts");
  addDetail("Карго/сушка/смітник",      valInt("furnCargo"),        "p_furn_cargo");
  addDetail("Магічний кут",             valInt("furnMagic"),        "p_furn_magic");
  addDetail("Servo-Drive",              valInt("furnServo"),        "p_furn_servo");
  addDetail("Консольні полиці",         valInt("furnConsole"),      "p_furn_console");
  addDetail("Верхні шухляди",           valInt("furnTopDrawers"),   "p_furn_top");
  addDetail("Системи розсувних дверей", valInt("furnSlidingDoors"), "p_furn_doors");
  addDetail("Slide M",                  valInt("furnSlideM"),       "p_furn_slide");

  // 7. Ручки - поінти тільки за конкретні типи
  const hasHandles = document.getElementById("hasHandles")?.value;
  if (hasHandles === "yes") {
    const handles = document.querySelectorAll('[id^="handle_"]');
    const handleMapping = {
      "handles_gola_low": "p_handle_gola_low",
      "handles_gola_up": "p_handle_gola_up",
      "handles_gola_vert": "p_handle_gola_vert",
      "handles_end": "p_handle_end",
      "handles_milled": "p_handle_milled",
      "handles_other": "p_handle_other"
    };
    
    handles.forEach(handle => {
      const handleType = handle.getAttribute('data-handle-type');
      const handleNames = {
        "handles_gola_low": "GOLA низ",
        "handles_gola_up": "GOLA верх",
        "handles_gola_vert": "GOLA вертикал.",
        "handles_end": "Торцеві",
        "handles_milled": "Фрезеровані",
        "handles_other": "Інші"
      };
      
      const handleName = handleNames[handleType] || handleType;
      if (handleType && handleMapping[handleType]) {
        addDetail("Ручки: " + handleName, 1, handleMapping[handleType]);
      }
    });
  }

  // 8. Підсвітка
  const hasLighting = document.getElementById("hasLighting")?.value;
  if (hasLighting === "yes") {
    const lights = document.querySelectorAll('[id^="lighting_"]');
    const lightingMapping = {
      "light_modules": "p_light_mod",
      "light_work": "p_light_work",
      "light_base": "p_light_base",
      "light_other": "p_light_other"
    };
    
    lights.forEach(light => {
      const lightingType = light.getAttribute('data-lighting-type');
      const quantity = parseInt(light.getAttribute('data-quantity')) || 1;
      const lightingNames = {
        "light_modules": "К-сть модулів (корпусів) з підсвіткою",
        "light_work": "Підсвітка робочої зони",
        "light_base": "Підсвітка цоколя",
        "light_other": "Інше (окремий модуль підсвітки, один відрізок)"
      };
      
      const lightingName = lightingNames[lightingType] || lightingType;
      if (lightingType && lightingMapping[lightingType]) {
        addDetail("Підсвітка: " + lightingName, quantity, lightingMapping[lightingType]);
      }
    });
  }

  // 9. Вбудована техніка
  addDetail("Вбудована техніка", valInt("appliancesCount"), "p_appliance");

  // Вивід - показуємо поінти тільки після успішного розрахунку
  const out = document.getElementById("pointsResult");
  if (out) {
    out.textContent = "Поінти: " + points;
    out.style.display = "block";
  }
  const hud = document.getElementById("pointsHUD");
  if (hud) {
    hud.textContent = "Поінти: " + points;
    hud.style.display = "inline-block";
  }
}

</script>
<!-- Результат розрахунку -->
<div id="resultBox" style="background:#f9fafb;border:1px solid #d1d5db;padding:12px;border-radius:8px;margin-top:20px;">
<h3>Результат розрахунку</h3>
<p id="pointsResult" style="font-size:18px;font-weight:bold;color:#1d4ed8;display:none;">Поінти: 0</p>
</div>
<script>
// ===== Persist settings (tariffs) and protect them from reset =====
document.addEventListener("DOMContentLoaded", () => {
  const settingsRoot = document.querySelector("#settingsModal, .settings-modal, [data-role='settings']");

  function saveSettings() {
    if (!settingsRoot) return;
    const data = {};
    settingsRoot.querySelectorAll("input, select, textarea").forEach(el => {
      const key = el.id || el.name;
      if (!key) return;
      if (el.type === "checkbox" || el.type === "radio") data[key] = el.checked ? "1" : "0";
      else data[key] = el.value;
    });
    try { localStorage.setItem("kitchen_points_settings", JSON.stringify(data)); } catch(_) {}
  }

  function loadSettings() {
    if (!settingsRoot) return;
    let data = null;
    try { data = JSON.parse(localStorage.getItem("kitchen_points_settings") || "null"); } catch(_) {}
    if (!data) return;
    settingsRoot.querySelectorAll("input, select, textarea").forEach(el => {
      const key = el.id || el.name;
      if (!key || !(key in data)) return;
      const val = data[key];
      if (el.type === "checkbox" || el.type === "radio") el.checked = val === "1";
      else el.value = val;
    });
  }

  // Save on change & at "Зберегти" click (if present)
  if (settingsRoot) {
    settingsRoot.addEventListener("change", saveSettings);
    settingsRoot.addEventListener("input", saveSettings);
    const saveBtn = Array.from(settingsRoot.querySelectorAll("button")).find(b => /зберегти/i.test(b.textContent));
    if (saveBtn) saveBtn.addEventListener("click", saveSettings);
  }
  loadSettings(); // restore settings on load

  // ===== Custom CLEAR (Очистити) for main form only =====
  // Find main form container (try to detect); fallback to document.body
  const formRoot = document.querySelector("#mainForm, form#calculatorForm, .calculator-form, main, .wrapper") || document.body;

  function clearMainFormOnly() {
    const settingsSet = new Set();
    if (settingsRoot) settingsRoot.querySelectorAll("*").forEach(n => settingsSet.add(n));

    const nodes = formRoot.querySelectorAll("input, select, textarea");
    nodes.forEach(el => {
      if (settingsSet.has(el)) return; // skip settings elements
      const tag = el.tagName.toLowerCase();
      if (tag === "input") {
        const t = (el.type || "").toLowerCase();
        if (["text","number","email","tel","search","url","password","date","time","datetime-local"].includes(t)) el.value = "";
        else if (t === "checkbox" || t === "radio") el.checked = false;
        else if (t === "range") { el.value = el.hasAttribute("min") ? el.getAttribute("min") : 0; }
        else if (t === "reset") { /* skip */ }
        else { try { if (el.id !== "dateField") el.value = ""; } catch(_) {} }
      } else if (tag === "select") {
        if (el.options && el.options.length > 0) el.selectedIndex = 0; else el.value = "";
      } else if (tag === "textarea") {
        if (el.id !== "dateField") el.value = "";
      }
      el.dispatchEvent(new Event("change", { bubbles: true }));
      el.dispatchEvent(new Event("input", { bubbles: true }));
    });
    
    // Приховуємо поінти при очищенні
    const out = document.getElementById("pointsResult");
    if (out) out.style.display = "none";
    const hud = document.getElementById("pointsHUD");
    if (hud) hud.style.display = "none";
  }

  // Wire up clear buttons
  const candidates = Array.from(document.querySelectorAll('button, input[type="reset"]'));
  const clearButtons = candidates.filter(el => {
    const txt = (el.textContent || el.value || "").trim().toLowerCase();
    return el.type === "reset" || ["очистити","скинути","очистка","clear","reset"].some(k => txt === k || txt.includes(k));
  });
  clearButtons.forEach(btn => {
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      // Просто перезавантажуємо сторінку
      location.reload();
    }, { capture: true });
  });
});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  function safeRecalc() { try { if (typeof calculateTotal === "function") calculateTotal(); } catch(e){} }
  // Автоматичний перерахунок відключений - поінти показуються тільки після натискання "Розрахувати"
});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  function safeRecalc(){ try{ if(typeof calculateTotal==="function") calculateTotal(); }catch(e){} }

  // Restore settings from localStorage (if present)
  const settingsRoot = document.querySelector('#settingsModal, .settings-modal, [data-role="settings"]');
  function loadSettings(){
    try{
      const raw = localStorage.getItem("kitchen_points_settings");
      if (!raw || !settingsRoot) return;
      const data = JSON.parse(raw);
      settingsRoot.querySelectorAll("input,select,textarea").forEach(el=>{
        const key = el.id || el.name;
        if (!key || !(key in data)) return;
        if (el.type === "checkbox" || el.type === "radio") el.checked = data[key] === "1";
        else el.value = data[key];
      });
    }catch(e){}
  }
  loadSettings();

  // Save settings on change (so Clear never loses them even if something touches them)
  if (settingsRoot){
    const saveSettings = ()=>{
      try{
        const obj = {};
        settingsRoot.querySelectorAll("input,select,textarea").forEach(el=>{
          const key = el.id || el.name;
          if (!key) return;
          obj[key] = (el.type==="checkbox"||el.type==="radio") ? (el.checked?"1":"0") : el.value;
        });
        localStorage.setItem("kitchen_points_settings", JSON.stringify(obj));
      }catch(e){}
    };
    settingsRoot.addEventListener("change", saveSettings);
    settingsRoot.addEventListener("input",  saveSettings);
  }

  // SCOPED CLEAR: clear only inside the same visual container as the clicked Clear button.
  const buttons = Array.from(document.querySelectorAll('button, input[type="reset"]')).filter(el=>{
    const txt = (el.textContent || el.value || "").trim().toLowerCase();
    const isClear = el.type==="reset" || ["очистити","скинути","очистка","clear","reset"].some(k=>txt===k || txt.includes(k));
    if (!isClear) return false;
    // Ignore buttons inside settings
    return !el.closest('#settingsModal, .settings-modal, [data-role="settings"], [id*="setting"], [class*="setting"]');
  });

  function findFormContainer(btn){
    // Prefer nearest <form>, else a big section container
    return btn.closest("form, .calculator-form, main, .wrapper, .container, .content, .card, section") || document.body;
  }

  buttons.forEach(btn=>{
    btn.addEventListener("click", (e)=>{
      e.preventDefault();
      // Просто перезавантажуємо сторінку
      location.reload();
    }, {capture:true});
  });

  // Автоматичний перерахунок відключений - поінти показуються тільки після натискання "Розрахувати"
});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  function safeRecalc(){ try{ if(typeof calculateTotal==="function") calculateTotal(); }catch(e){} }

  function isInSettings(el) {
    return !!(el && el.closest('#settingsModal, .settings-modal, [data-role="settings"], [id*="setting"], [class*="setting"]'));
  }

  function clearMainFormFrom(rootNode){
    // find a broad container for the calculator form
    const formRoot = rootNode?.closest("form, .calculator-form, main, .wrapper, .container, .content, section") || document.querySelector("main, .wrapper, .container, .content") || document.body;
    const nodes = formRoot.querySelectorAll("input, select, textarea");
    nodes.forEach(el=>{
      if (isInSettings(el)) return; // do NOT touch settings
      if (el.id === "dateField") return; // НЕ очищуємо дату
      const tag = el.tagName.toLowerCase();
      if (tag === "input") {
        const t = (el.type || "").toLowerCase();
        if (["text","number","email","tel","search","url","password","date","time","datetime-local"].includes(t)) el.value = "";
        else if (t === "checkbox" || t === "radio") el.checked = false;
        else if (t === "range") el.value = el.min || "0";
        else if (t === "reset" || t === "button" || t === "submit") { /* skip */ }
        else { try { if (el.id !== "dateField") el.value = ""; } catch(_) {} }
      } else if (tag === "select") {
        if (el.options && el.options.length) el.selectedIndex = 0; else if (el.id !== "dateField") el.value = "";
      } else if (tag === "textarea") {
        if (el.id !== "dateField") el.value = "";
      }
      el.dispatchEvent(new Event("input", {bubbles:true}));
      el.dispatchEvent(new Event("change", {bubbles:true}));
    });
    
    // Приховуємо поінти при очищенні
    const out = document.getElementById("pointsResult");
    if (out) out.style.display = "none";
    const hud = document.getElementById("pointsHUD");
    if (hud) hud.style.display = "none";
  }

  const topBtn = document.getElementById("topClearBtn");
  if (topBtn) {
    topBtn.addEventListener("click", (e)=>{
      e.preventDefault();
      // Просто перезавантажуємо сторінку
      location.reload();
    });
  }
});
</script>
<script>
// Автоматичний перерахунок відключений - поінти показуються тільки після натискання "Розрахувати"
</script>

</div></div>

<!-- Модальне вікно для додавання фасадного матеріалу -->
<div id="addFacadeMaterialModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Додати фасадний матеріал</h3>
      <span class="close" onclick="closeAddFacadeMaterialModal()">&times;</span>
    </div>
    <label for="newFacadeMaterialType">Тип матеріалу:</label>
    <select id="newFacadeMaterialType" onchange="addFacadeMaterialOnSelect()">
      <option value="">-- Виберіть --</option>
      <option value="dsp_mat">ДСП мат.корпусу</option>
      <option value="dsp">ДСП</option>
      <option value="mdf">МДФ плити</option>
      <option value="paint_straight">Фарба/плівка "прямі"</option>
      <option value="paint_milled">Фарба/плівка "фрезеровані"</option>
      <option value="veneer_straight">Шпоновані "прямі"</option>
      <option value="veneer_milled">Шпоновані "фрезеровані"</option>
      <option value="alum_frame">Алюм. рамкові</option>
      <option value="arpa">ARPA/Fenix</option>
      <option value="fiushin">Fiushin</option>
      <option value="hpl">HPL</option>
      <option value="rd_individual">R&D фасади індивід.</option>
      <option value="mdf_individual">МДФ фасади з індивідуальним фрезеруванням</option>
    </select>
    <div class="modal-actions">
      <button onclick="closeAddFacadeMaterialModal()">Скасувати</button>
    </div>
  </div>
</div>

<!-- Модальне вікно для додавання додаткових елементів -->
<div id="addAdditionalElementModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Додати додатковий елемент</h3>
      <span class="close" onclick="closeAddAdditionalElementModal()">&times;</span>
    </div>
    <label for="newAdditionalElementType">Тип елементу:</label>
    <select id="newAdditionalElementType" style="width: 100%; margin-bottom: 15px;">
      <option value="">-- Виберіть --</option>
      <option value="false_hor">Фальш горизонтальні</option>
      <option value="false_ver">Фальш вертикальні</option>
      <option value="detail_rd">Деталь R&D, гнутий елемент тощо</option>
      <option value="metal_frame">Металоконструкція рамкова</option>
      <option value="metal_volume">Металоконструкція об'ємна</option>
    </select>
    <label for="newAdditionalElementQuantity">Кількість:</label>
    <input type="number" id="newAdditionalElementQuantity" min="1" value="1" style="width: 100%; margin-bottom: 15px;">
    <div class="modal-actions">
      <button onclick="closeAddAdditionalElementModal()" style="background: #6b7280;">Скасувати</button>
      <button onclick="addAdditionalElement()" style="background: #2563eb;">Додати</button>
    </div>
  </div>
</div>

<!-- Модальне вікно для додавання ручок -->
<div id="addHandleModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Додати ручку</h3>
      <span class="close" onclick="closeAddHandleModal()">&times;</span>
    </div>
    <label for="newHandleType">Тип ручки:</label>
    <select id="newHandleType" style="width: 100%; margin-bottom: 15px;">
      <option value="">-- Виберіть --</option>
      <option value="handles_gola_low">GOLA низ</option>
      <option value="handles_gola_up">GOLA верх</option>
      <option value="handles_gola_vert">GOLA вертикал.</option>
      <option value="handles_end">Торцеві</option>
      <option value="handles_milled">Фрезеровані</option>
      <option value="handles_other">Інші</option>
    </select>
    <div class="modal-actions">
      <button onclick="closeAddHandleModal()" style="background: #6b7280;">Скасувати</button>
      <button onclick="addHandle()" style="background: #2563eb;">Додати</button>
    </div>
  </div>
</div>

<!-- Модальне вікно для додавання підсвітки -->
<div id="addLightingModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Додати підсвітку</h3>
      <span class="close" onclick="closeAddLightingModal()">&times;</span>
    </div>
    <label for="newLightingType">Тип підсвітки:</label>
    <select id="newLightingType" onchange="showLightingQuantityField()" style="width: 100%; margin-bottom: 15px;">
      <option value="">-- Виберіть --</option>
      <option value="light_modules">К-сть модулів (корпусів) з підсвіткою (в боковинах, полицях, ящиках)</option>
      <option value="light_work">Підсвітка робочої зони</option>
      <option value="light_base">Підсвітка цоколя</option>
      <option value="light_other">Інше (окремий модуль підсвітки, один відрізок)</option>
    </select>
    
    <div id="lightingQuantityField" style="display: none; margin-bottom: 15px;">
      <label for="newLightingQuantity">Кількість модулів:<span class="tooltip-container"><span class="tooltip-icon">?</span><div class="tooltip-content">Підсвітка в середині модулів-пеналів (в боковинах, полицях, підсвітка ящиків тощо)</div></span></label>
      <input type="number" id="newLightingQuantity" min="1" value="1" style="width: 100%;">
    </div>
    
    <div class="modal-actions" style="margin-top: 15px;">
      <button onclick="addLightingFromModal()">Додати</button>
      <button onclick="closeAddLightingModal()">Скасувати</button>
    </div>
  </div>
</div>

</body>
</html>
<!-- Модальне вікно для додавання стільниці -->
<div id="addCountertopModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Додати стільницю</h3>
      <span class="close" onclick="closeAddCountertopModal()">&times;</span>
    </div>
    <div>
      <label for="newCountertopMaterial">Матеріал:</label><br/>
      <select id="newCountertopMaterial" style="width: 100%; margin-bottom: 15px;">
        <option value="">-- Виберіть матеріал --</option>
        <option value="dsp_mdf">ДСП-МДФ</option>
        <option value="ceramic">Керамограніт-Кварц</option>
        <option value="hpl">HPL</option>
        <option value="acryl">Акрил</option>
        <option value="rd">R&D (дерево-метал)</option>
      </select>
      
      <label for="newCountertopShape">Форма:</label><br/>
      <select id="newCountertopShape" style="width: 100%; margin-bottom: 15px;">
        <option value="">-- Виберіть форму --</option>
        <option value="straight">Прямий</option>
        <option value="g_shape">Г-подібний</option>
        <option value="p_shape">П-подібний</option>
      </select>
      
      <label for="newCountertopDrops">Наявність опусків:</label><br/>
      <select id="newCountertopDrops" style="width: 100%; margin-bottom: 15px;">
        <option value="">-- Виберіть --</option>
        <option value="yes">Так</option>
        <option value="no">Ні</option>
      </select>
    </div>
    <div class="modal-actions">
      <button onclick="closeAddCountertopModal()" style="background: #6b7280;">Скасувати</button>
      <button onclick="addCountertop()" style="background: #2563eb;">Додати</button>
    </div>
  </div>
</div>

<script>
(function(){
  function safeRecalc(){ try{ if(typeof calculateTotal==="function") calculateTotal(); }catch(e){} }
  // Автоматичний перерахунок відключений - поінти показуються тільки після натискання "Розрахувати"
})();
</script>

